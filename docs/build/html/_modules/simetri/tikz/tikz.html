<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>simetri.tikz.tikz &#8212; simetri.graphics 0.0.5 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../../../_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=27fed22d" />
    <script src="../../../_static/documentation_options.js?v=282f96c0"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for simetri.tikz.tikz</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;TikZ exporter. Draws shapes using the TikZ package for LaTeX.</span>
<span class="sd">Sketch objects are converted to TikZ code.&quot;&quot;&quot;</span>

<span class="c1"># This is a proof of concept.</span>
<span class="c1"># To do: This whole module needs to be restructured.</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">__future__</span><span class="w"> </span><span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">math</span><span class="w"> </span><span class="kn">import</span> <span class="n">degrees</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">ceil</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Union</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">field</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">simetri.graphics</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sg</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">..graphics.common</span><span class="w"> </span><span class="kn">import</span> <span class="n">common_properties</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">..graphics.all_enums</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">BackStyle</span><span class="p">,</span>
    <span class="n">FontSize</span><span class="p">,</span>
    <span class="n">FontFamily</span><span class="p">,</span>
    <span class="n">MarkerType</span><span class="p">,</span>
    <span class="n">ShadeType</span><span class="p">,</span>
    <span class="n">Types</span><span class="p">,</span>
    <span class="n">TexLoc</span><span class="p">,</span>
    <span class="n">FrameShape</span><span class="p">,</span>
    <span class="n">DocumentClass</span><span class="p">,</span>
    <span class="n">Align</span><span class="p">,</span>
    <span class="n">ArrowLine</span><span class="p">,</span>
    <span class="n">BlendMode</span><span class="p">,</span>
    <span class="n">get_enum_value</span><span class="p">,</span>
    <span class="n">LineWidth</span><span class="p">,</span>
    <span class="n">LineDashArray</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">..canvas.style_map</span><span class="w"> </span><span class="kn">import</span> <span class="n">shape_style_map</span><span class="p">,</span> <span class="n">line_style_map</span><span class="p">,</span> <span class="n">marker_style_map</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">..settings.settings</span><span class="w"> </span><span class="kn">import</span> <span class="n">defaults</span><span class="p">,</span> <span class="n">tikz_defaults</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">..geometry.geometry</span><span class="w"> </span><span class="kn">import</span> <span class="n">homogenize</span><span class="p">,</span> <span class="n">close_points2</span><span class="p">,</span> <span class="n">round_point</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">..geometry.ellipse</span><span class="w"> </span><span class="kn">import</span> <span class="n">ellipse_point</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">..graphics.sketch</span><span class="w"> </span><span class="kn">import</span> <span class="n">TagSketch</span><span class="p">,</span> <span class="n">ShapeSketch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">..graphics.shape</span><span class="w"> </span><span class="kn">import</span> <span class="n">Shape</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">..colors</span><span class="w"> </span><span class="kn">import</span> <span class="n">Color</span>


<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">legacy</span><span class="o">=</span><span class="s2">&quot;1.21&quot;</span><span class="p">)</span>
<span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span>


<span class="n">enum_map</span> <span class="o">=</span> <span class="p">{}</span>


<div class="viewcode-block" id="scope_code_required">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.scope_code_required">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">scope_code_required</span><span class="p">(</span><span class="n">item</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Canvas&quot;</span><span class="p">,</span> <span class="s2">&quot;Batch&quot;</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if a TikZ namespace is required for the item.</span>

<span class="sd">    Args:</span>
<span class="sd">        item (Union[&quot;Canvas&quot;, &quot;Batch&quot;]): The item to check.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if a TikZ namespace is required, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">item</span><span class="o">.</span><span class="n">blend_mode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="ow">or</span> <span class="n">item</span><span class="o">.</span><span class="n">transparency_group</span>
        <span class="ow">or</span> <span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">clip</span> <span class="ow">and</span> <span class="n">item</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>
    <span class="p">)</span></div>



<div class="viewcode-block" id="Tex">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.Tex">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Tex</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Tex class for generating tex code.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        begin_document (str): The beginning of the document.</span>
<span class="sd">        end_document (str): The end of the document.</span>
<span class="sd">        begin_tikz (str): The beginning of the TikZ environment.</span>
<span class="sd">        end_tikz (str): The end of the TikZ environment.</span>
<span class="sd">        packages (List[str]): List of required TeX packages.</span>
<span class="sd">        tikz_libraries (List[str]): List of required TikZ libraries.</span>
<span class="sd">        tikz_code (str): The generated TikZ code.</span>
<span class="sd">        sketches (List[&quot;Sketch&quot;]): List of TexSketch objects.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">begin_document</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;begin_doc&quot;</span><span class="p">]</span>
    <span class="n">end_document</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;end_doc&quot;</span><span class="p">]</span>
    <span class="n">begin_tikz</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;begin_tikz&quot;</span><span class="p">]</span>
    <span class="n">end_tikz</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;end_tikz&quot;</span><span class="p">]</span>
    <span class="n">packages</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">tikz_libraries</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">tikz_code</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>  <span class="c1"># Generated by the canvas by using sketches</span>
    <span class="n">sketches</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;Sketch&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>  <span class="c1"># List of TexSketch objects</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Post-initialization method.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">TEX</span>
        <span class="n">common_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<div class="viewcode-block" id="Tex.tex_code">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.Tex.tex_code">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">tex_code</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">canvas</span><span class="p">:</span> <span class="s2">&quot;Canvas&quot;</span><span class="p">,</span> <span class="n">aux_code</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate the final TeX code.</span>

<span class="sd">        Args:</span>
<span class="sd">            canvas (&quot;Canvas&quot;): The canvas object.</span>
<span class="sd">            aux_code (str): Auxiliary code to include.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The final TeX code.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">doc_code</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">sketch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sketches</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">location</span> <span class="o">==</span> <span class="n">TexLoc</span><span class="o">.</span><span class="n">DOCUMENT</span><span class="p">:</span>
                <span class="n">doc_code</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sketch</span><span class="o">.</span><span class="n">code</span><span class="p">)</span>
        <span class="n">doc_code</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">doc_code</span><span class="p">)</span>
        <span class="n">back_color</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">pagecolor</span><span class="si">{</span><span class="n">color2tikz</span><span class="p">(</span><span class="n">canvas</span><span class="o">.</span><span class="n">back_color</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">begin_document</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">begin_document</span> <span class="o">+</span> <span class="n">back_color</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">canvas</span><span class="o">.</span><span class="n">limits</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">begin_tikz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">begin_tikz</span> <span class="o">+</span> <span class="n">get_limits_code</span><span class="p">(</span><span class="n">canvas</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">begin_tikz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">begin_tikz</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">scope_code_required</span><span class="p">(</span><span class="n">canvas</span><span class="p">):</span>
            <span class="n">scope</span> <span class="o">=</span> <span class="n">get_canvas_scope</span><span class="p">(</span><span class="n">canvas</span><span class="p">)</span>
            <span class="n">code</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get_preamble</span><span class="p">(</span><span class="n">canvas</span><span class="p">)</span>
                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">begin_document</span>
                <span class="o">+</span> <span class="n">doc_code</span>
                <span class="o">+</span> <span class="n">begin_tikz</span>
                <span class="o">+</span> <span class="n">scope</span>
                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_tikz_code</span><span class="p">()</span>
                <span class="o">+</span> <span class="n">aux_code</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">end</span><span class="si">{scope}</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_tikz</span>
                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_document</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">code</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get_preamble</span><span class="p">(</span><span class="n">canvas</span><span class="p">)</span>
                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">begin_document</span>
                <span class="o">+</span> <span class="n">doc_code</span>
                <span class="o">+</span> <span class="n">begin_tikz</span>
                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_tikz_code</span><span class="p">()</span>
                <span class="o">+</span> <span class="n">aux_code</span>
                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_tikz</span>
                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_document</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">code</span></div>


<div class="viewcode-block" id="Tex.get_doc_class">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.Tex.get_doc_class">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_doc_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">border</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">font_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the document class.</span>

<span class="sd">        Args:</span>
<span class="sd">            border (float): The border size.</span>
<span class="sd">            font_size (int): The font size.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The document class string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">documentclass[</span><span class="si">{</span><span class="n">font_size</span><span class="si">}</span><span class="s2">pt,tikz,border=</span><span class="si">{</span><span class="n">border</span><span class="si">}</span><span class="s2">pt]</span><span class="se">{{</span><span class="s2">standalone</span><span class="se">}}\n</span><span class="s2">&quot;</span></div>


<div class="viewcode-block" id="Tex.get_tikz_code">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.Tex.get_tikz_code">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_tikz_code</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the TikZ code.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The TikZ code.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">code</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">sketch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sketches</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">location</span> <span class="o">==</span> <span class="n">TexLoc</span><span class="o">.</span><span class="n">PICTURE</span><span class="p">:</span>
                <span class="n">code</span> <span class="o">+=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">text</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">return</span> <span class="n">code</span></div>


<div class="viewcode-block" id="Tex.get_tikz_libraries">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.Tex.get_tikz_libraries">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_tikz_libraries</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the TikZ libraries.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The TikZ libraries string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">usetikzlibrary</span><span class="se">{{</span><span class="si">{</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tikz_libraries</span><span class="p">)</span><span class="si">}</span><span class="se">}}\n</span><span class="s2">&quot;</span></div>


<div class="viewcode-block" id="Tex.get_packages">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.Tex.get_packages">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_packages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">canvas</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the required TeX packages.</span>

<span class="sd">        Args:</span>
<span class="sd">            canvas: The canvas object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The required TeX packages.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tikz_libraries</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">tikz_packages</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;tikz&#39;</span><span class="p">,</span> <span class="s1">&#39;pgf&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">canvas</span><span class="o">.</span><span class="n">pages</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">sketch</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">sketches</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">draw_markers</span><span class="p">:</span>
                    <span class="k">if</span> <span class="s1">&#39;patterns&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tikz_libraries</span><span class="p">:</span>
                        <span class="n">tikz_libraries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;patterns&quot;</span><span class="p">)</span>
                        <span class="n">tikz_libraries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;patterns.meta&quot;</span><span class="p">)</span>
                        <span class="n">tikz_libraries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;backgrounds&quot;</span><span class="p">)</span>
                        <span class="n">tikz_libraries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;shadings&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">subtype</span> <span class="o">==</span> <span class="n">Types</span><span class="o">.</span><span class="n">TAG_SKETCH</span><span class="p">:</span>
                    <span class="k">if</span> <span class="s2">&quot;fontspec&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tikz_packages</span><span class="p">:</span>
                        <span class="n">tikz_packages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;fontspec&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sketch</span><span class="p">,</span> <span class="s2">&quot;marker_type&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">sketch</span><span class="o">.</span><span class="n">marker_type</span> <span class="o">==</span> <span class="s2">&quot;indices&quot;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="s2">&quot;fontspec&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tikz_packages</span><span class="p">:</span>
                            <span class="n">tikz_packages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;fontspec&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sketch</span><span class="p">,</span> <span class="s1">&#39;back_style&#39;</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">back_style</span> <span class="o">==</span> <span class="n">BackStyle</span><span class="o">.</span><span class="n">COLOR</span><span class="p">:</span>
                        <span class="k">if</span> <span class="s2">&quot;xcolor&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tikz_packages</span><span class="p">:</span>
                            <span class="n">tikz_packages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;xcolor&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">back_style</span> <span class="o">==</span> <span class="n">BackStyle</span><span class="o">.</span><span class="n">SHADING</span><span class="p">:</span>
                        <span class="k">if</span> <span class="s2">&quot;shadings&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tikz_libraries</span><span class="p">:</span>
                            <span class="n">tikz_libraries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;shadings&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">back_style</span> <span class="o">==</span> <span class="n">BackStyle</span><span class="o">.</span><span class="n">PATTERN</span><span class="p">:</span>
                        <span class="k">if</span> <span class="s2">&quot;patterns&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tikz_libraries</span><span class="p">:</span>
                            <span class="n">tikz_libraries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;patterns&quot;</span><span class="p">)</span>
                            <span class="n">tikz_libraries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;patterns.meta&quot;</span><span class="p">)</span>


        <span class="k">return</span> <span class="n">tikz_libraries</span><span class="p">,</span> <span class="n">tikz_packages</span></div>


<div class="viewcode-block" id="Tex.get_preamble">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.Tex.get_preamble">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_preamble</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">canvas</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the TeX preamble.</span>

<span class="sd">        Args:</span>
<span class="sd">            canvas: The canvas object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The TeX preamble.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">libraries</span><span class="p">,</span> <span class="n">packages</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_packages</span><span class="p">(</span><span class="n">canvas</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">packages</span><span class="p">:</span>
            <span class="n">packages</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">usepackage</span><span class="se">{{</span><span class="si">{</span><span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">packages</span><span class="p">)</span><span class="si">}</span><span class="se">}}\n</span><span class="s1">&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;fontspec&#39;</span> <span class="ow">in</span> <span class="n">packages</span><span class="p">:</span>
                <span class="n">fonts_section</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\\</span><span class="s2">setmainfont</span><span class="se">{{</span><span class="si">{</span><span class="n">defaults</span><span class="p">[</span><span class="s1">&#39;main_font&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">}}</span>
<span class="se">\\</span><span class="s2">setsansfont</span><span class="se">{{</span><span class="si">{</span><span class="n">defaults</span><span class="p">[</span><span class="s1">&#39;sans_font&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">}}</span>
<span class="se">\\</span><span class="s2">setmonofont</span><span class="se">{{</span><span class="si">{</span><span class="n">defaults</span><span class="p">[</span><span class="s1">&#39;mono_font&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">}}\n</span><span class="s2">&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">libraries</span><span class="p">:</span>
            <span class="n">libraries</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">usetikzlibrary</span><span class="se">{{</span><span class="si">{</span><span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">libraries</span><span class="p">)</span><span class="si">}</span><span class="se">}}\n</span><span class="s1">&#39;</span>

        <span class="k">if</span> <span class="n">canvas</span><span class="o">.</span><span class="n">border</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">border</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;border&quot;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">canvas</span><span class="o">.</span><span class="n">border</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="n">border</span> <span class="o">=</span> <span class="n">canvas</span><span class="o">.</span><span class="n">border</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Canvas.border must be a positive numeric value.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">border</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Canvas.border must be a positive numeric value.&quot;</span><span class="p">)</span>
        <span class="n">doc_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_doc_class</span><span class="p">(</span><span class="n">border</span><span class="p">,</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;font_size&quot;</span><span class="p">])</span>
        <span class="c1"># Check if different fonts are used</span>
        <span class="n">fonts_section</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">fonts</span> <span class="o">=</span> <span class="n">canvas</span><span class="o">.</span><span class="n">get_fonts_list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">font</span> <span class="ow">in</span> <span class="n">fonts</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">font</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">font_family</span> <span class="o">=</span> <span class="n">font</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">fonts_section</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">newfontfamily</span><span class="se">\\</span><span class="si">{</span><span class="n">font_family</span><span class="si">}</span><span class="s2">[Scale=1.0]</span><span class="se">{{</span><span class="si">{</span><span class="n">font</span><span class="si">}</span><span class="se">}}\n</span><span class="s2">&quot;</span>
        <span class="n">preamble</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">doc_class</span><span class="si">}{</span><span class="n">packages</span><span class="si">}{</span><span class="n">libraries</span><span class="si">}{</span><span class="n">fonts_section</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="n">indices</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">sketch</span> <span class="ow">in</span> <span class="n">canvas</span><span class="o">.</span><span class="n">active_page</span><span class="o">.</span><span class="n">sketches</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sketch</span><span class="p">,</span> <span class="s2">&quot;marker_type&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">sketch</span><span class="o">.</span><span class="n">marker_type</span> <span class="o">==</span> <span class="s2">&quot;indices&quot;</span><span class="p">:</span>
                <span class="n">indices</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">indices</span><span class="p">:</span>
            <span class="n">font_family</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;indices_font_family&quot;</span><span class="p">]</span>
            <span class="n">font_size</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;indices_font_size&quot;</span><span class="p">]</span>
            <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">sketch</span> <span class="ow">in</span> <span class="n">canvas</span><span class="o">.</span><span class="n">active_page</span><span class="o">.</span><span class="n">sketches</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sketch</span><span class="p">,</span> <span class="s2">&quot;marker_type&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">sketch</span><span class="o">.</span><span class="n">marker_type</span> <span class="o">==</span> <span class="s2">&quot;indices&quot;</span><span class="p">:</span>
                    <span class="n">preamble</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">tikzset{</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">node_style</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;nodestyle</span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2">/.style=</span><span class="se">{{</span><span class="s2">draw, circle, gray, &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;text=black, fill=white, line width = .5, inner sep=.5, &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;font=</span><span class="se">\\</span><span class="si">{</span><span class="n">font_family</span><span class="si">}</span><span class="se">\\</span><span class="si">{</span><span class="n">font_size</span><span class="si">}</span><span class="se">}}\n}}\n</span><span class="s2">&quot;</span>
                    <span class="p">)</span>
                    <span class="n">preamble</span> <span class="o">+=</span> <span class="n">node_style</span>
                    <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="n">preamble</span></div>
</div>



<div class="viewcode-block" id="get_back_grid_code">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.get_back_grid_code">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_back_grid_code</span><span class="p">(</span><span class="n">grid</span><span class="p">:</span> <span class="n">Grid</span><span class="p">,</span> <span class="n">canvas</span><span class="p">:</span> <span class="s2">&quot;Canvas&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Page background grid code.</span>

<span class="sd">    Args:</span>
<span class="sd">        grid (Grid): The grid object.</span>
<span class="sd">        canvas (&quot;Canvas&quot;): The canvas object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The background grid code.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># \usetikzlibrary{backgrounds}</span>
    <span class="c1"># \begin{scope}[on background layer]</span>
    <span class="c1"># \fill[gray] (current bounding box.south west) rectangle</span>
    <span class="c1"># (current bounding box.north east);</span>
    <span class="c1"># \draw[white,step=.5cm] (current bounding box.south west) grid</span>
    <span class="c1"># (current bounding box.north east);</span>
    <span class="c1"># \end{scope}</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">canvas</span><span class="o">.</span><span class="n">active_page</span><span class="o">.</span><span class="n">grid</span>
    <span class="n">back_color</span> <span class="o">=</span> <span class="n">color2tikz</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">back_color</span><span class="p">)</span>
    <span class="n">line_color</span> <span class="o">=</span> <span class="n">color2tikz</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">line_color</span><span class="p">)</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">spacing</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">begin</span><span class="si">{scope}</span><span class="s2">[on background layer]</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">]</span>
    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">fill[color=</span><span class="si">{</span><span class="n">back_color</span><span class="si">}</span><span class="s2">] (current bounding box.south west) &quot;</span><span class="p">)</span>
    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;rectangle (current bounding box.north east);</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">options</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">grid</span><span class="o">.</span><span class="n">line_dash_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">options</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;dashed, dash pattern=</span><span class="si">{</span><span class="n">get_dash_pattern</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">line_dash_array</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">grid</span><span class="o">.</span><span class="n">line_width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">options</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;line width=</span><span class="si">{</span><span class="n">grid</span><span class="o">.</span><span class="n">line_width</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">options</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">draw[color=</span><span class="si">{</span><span class="n">line_color</span><span class="si">}</span><span class="s2">, step=</span><span class="si">{</span><span class="n">step</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">options</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">draw[color=</span><span class="si">{</span><span class="n">line_color</span><span class="si">}</span><span class="s2">,step=</span><span class="si">{</span><span class="n">step</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;(current bounding box.south west)&quot;</span><span class="p">)</span>
    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot; grid (current bounding box.north east);</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">end</span><span class="si">{scope}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span></div>



<div class="viewcode-block" id="get_limits_code">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.get_limits_code">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_limits_code</span><span class="p">(</span><span class="n">canvas</span><span class="p">:</span> <span class="s2">&quot;Canvas&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the limits of the canvas for clipping.</span>

<span class="sd">    Args:</span>
<span class="sd">        canvas (&quot;Canvas&quot;): The canvas object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The limits code for clipping.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">canvas</span><span class="o">.</span><span class="n">limits</span>
    <span class="n">points</span> <span class="o">=</span> <span class="p">[(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">),</span> <span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">),</span> <span class="p">(</span><span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span><span class="p">),</span> <span class="p">(</span><span class="n">xmax</span><span class="p">,</span> <span class="n">ymin</span><span class="p">)]</span>
    <span class="n">vertices</span> <span class="o">=</span> <span class="n">homogenize</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">@</span> <span class="n">canvas</span><span class="o">.</span><span class="n">xform_matrix</span>
    <span class="n">coords</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">])</span>

    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">clip plot[] coordinates </span><span class="se">{{</span><span class="si">{</span><span class="n">coords</span><span class="si">}</span><span class="se">}}</span><span class="s2">;</span><span class="se">\n</span><span class="s2">&quot;</span></div>



<div class="viewcode-block" id="get_back_code">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.get_back_code">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_back_code</span><span class="p">(</span><span class="n">canvas</span><span class="p">:</span> <span class="s2">&quot;Canvas&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the background code for the canvas.</span>

<span class="sd">    Args:</span>
<span class="sd">        canvas (&quot;Canvas&quot;): The canvas object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The background code.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">back_color</span> <span class="o">=</span> <span class="n">color2tikz</span><span class="p">(</span><span class="n">canvas</span><span class="o">.</span><span class="n">back_color</span><span class="p">)</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">pagecolor</span><span class="si">{</span><span class="n">back_color</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span></div>



<div class="viewcode-block" id="get_tex_code">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.get_tex_code">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_tex_code</span><span class="p">(</span><span class="n">canvas</span><span class="p">:</span> <span class="s2">&quot;Canvas&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert the sketches in the Canvas to TikZ code.</span>

<span class="sd">    Args:</span>
<span class="sd">        canvas (&quot;Canvas&quot;): The canvas object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The TikZ code.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_sketch_code</span><span class="p">(</span><span class="n">sketch</span><span class="p">,</span> <span class="n">canvas</span><span class="p">,</span> <span class="n">ind</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the TikZ code for a sketch.</span>

<span class="sd">        Args:</span>
<span class="sd">            sketch: The sketch object.</span>
<span class="sd">            canvas: The canvas object.</span>
<span class="sd">            ind: The index.</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple: The TikZ code and the updated index.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">subtype</span> <span class="o">==</span> <span class="n">Types</span><span class="o">.</span><span class="n">TAG_SKETCH</span><span class="p">:</span>
            <span class="n">code</span> <span class="o">=</span> <span class="n">draw_tag_sketch</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">sketch</span><span class="o">.</span><span class="n">subtype</span> <span class="o">==</span> <span class="n">Types</span><span class="o">.</span><span class="n">BBOX_SKETCH</span><span class="p">:</span>
            <span class="n">code</span> <span class="o">=</span> <span class="n">draw_bbox_sketch</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">sketch</span><span class="o">.</span><span class="n">subtype</span> <span class="o">==</span> <span class="n">Types</span><span class="o">.</span><span class="n">PATTERN_SKETCH</span><span class="p">:</span>
            <span class="n">code</span> <span class="o">=</span> <span class="n">draw_pattern_sketch</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">draw_markers</span> <span class="ow">and</span> <span class="n">sketch</span><span class="o">.</span><span class="n">marker_type</span> <span class="o">==</span> <span class="n">MarkerType</span><span class="o">.</span><span class="n">INDICES</span><span class="p">:</span>
                <span class="n">code</span> <span class="o">=</span> <span class="n">draw_shape_sketch</span><span class="p">(</span><span class="n">sketch</span><span class="p">,</span> <span class="n">ind</span><span class="p">)</span>
                <span class="n">ind</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">code</span> <span class="o">=</span> <span class="n">draw_shape_sketch</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">code</span><span class="p">,</span> <span class="n">ind</span>

    <span class="n">pages</span> <span class="o">=</span> <span class="n">canvas</span><span class="o">.</span><span class="n">pages</span>

    <span class="k">if</span> <span class="n">pages</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">page</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pages</span><span class="p">):</span>
            <span class="n">sketches</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">sketches</span>
            <span class="n">back_color</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">pagecolor</span><span class="si">{</span><span class="n">color2tikz</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">back_color</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">code</span> <span class="o">=</span> <span class="p">[</span><span class="n">back_color</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">code</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;end_tikz&quot;</span><span class="p">])</span>
                <span class="n">code</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">newpage&quot;</span><span class="p">)</span>
                <span class="n">code</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;begin_tikz&quot;</span><span class="p">])</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">sketch</span> <span class="ow">in</span> <span class="n">sketches</span><span class="p">:</span>
                <span class="n">sketch_code</span><span class="p">,</span> <span class="n">ind</span> <span class="o">=</span> <span class="n">get_sketch_code</span><span class="p">(</span><span class="n">sketch</span><span class="p">,</span> <span class="n">canvas</span><span class="p">,</span> <span class="n">ind</span><span class="p">)</span>
                <span class="n">code</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sketch_code</span><span class="p">)</span>

        <span class="n">code</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No pages found in the canvas.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">canvas</span><span class="o">.</span><span class="n">tex</span><span class="o">.</span><span class="n">tex_code</span><span class="p">(</span><span class="n">canvas</span><span class="p">,</span> <span class="n">code</span><span class="p">)</span></div>



<div class="viewcode-block" id="Grid">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.Grid">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Grid</span><span class="p">(</span><span class="n">sg</span><span class="o">.</span><span class="n">Shape</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Grid shape.</span>

<span class="sd">    Args:</span>
<span class="sd">        p1: (x_min, y_min)</span>
<span class="sd">        p2: (x_max, y_max)</span>
<span class="sd">        dx: x step</span>
<span class="sd">        dy: y step</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            p1: (x_min, y_min)</span>
<span class="sd">            p2: (x_max, y_max)</span>
<span class="sd">            dx: x step</span>
<span class="sd">            dy: y step</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p1</span> <span class="o">=</span> <span class="n">p1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p2</span> <span class="o">=</span> <span class="n">p2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dx</span> <span class="o">=</span> <span class="n">dx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dy</span> <span class="o">=</span> <span class="n">dy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">primary_points</span> <span class="o">=</span> <span class="n">sg</span><span class="o">.</span><span class="n">Points</span><span class="p">([</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stroke</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_b_box</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">([</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">],</span> <span class="n">xform_matrix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">subtype</span><span class="o">=</span><span class="n">sg</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">GRID</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>



<div class="viewcode-block" id="get_min_size">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.get_min_size">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_min_size</span><span class="p">(</span><span class="n">sketch</span><span class="p">:</span> <span class="n">ShapeSketch</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the minimum size of the tag node.</span>

<span class="sd">    Args:</span>
<span class="sd">        sketch (ShapeSketch): The shape sketch object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The minimum size of the tag node.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">frame_shape</span> <span class="o">==</span> <span class="s2">&quot;rectangle&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">frame_min_width</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">width</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;min_width&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">width</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">frame_min_width</span>
        <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">frame_min_height</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">height</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;min_height&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">height</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">frame_min_height</span>
        <span class="n">options</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;minimum width = </span><span class="si">{</span><span class="n">width</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">options</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;minimum height = </span><span class="si">{</span><span class="n">height</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">frame_min_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">min_size</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;min_size&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">min_size</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">frame_min_size</span>
        <span class="n">options</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;minimum size = </span><span class="si">{</span><span class="n">min_size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">options</span></div>



<div class="viewcode-block" id="frame_options">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.frame_options">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">frame_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">:</span> <span class="n">TagSketch</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the options for the frame of the tag node.</span>

<span class="sd">    Args:</span>
<span class="sd">        sketch (TagSketch): The tag sketch object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[str]: The options for the frame of the tag node.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">draw_frame</span><span class="p">:</span>
        <span class="n">options</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sketch</span><span class="o">.</span><span class="n">frame_shape</span><span class="p">)</span>
        <span class="n">line_options</span> <span class="o">=</span> <span class="n">get_line_style_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">line_options</span><span class="p">:</span>
            <span class="n">options</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">line_options</span><span class="p">)</span>
        <span class="n">fill_options</span> <span class="o">=</span> <span class="n">get_fill_style_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fill_options</span><span class="p">:</span>
            <span class="n">options</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">fill_options</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">text</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]:</span>
            <span class="n">min_size</span> <span class="o">=</span> <span class="n">get_min_size</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">min_size</span><span class="p">:</span>
                <span class="n">options</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">min_size</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">options</span></div>



<div class="viewcode-block" id="color2tikz">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.color2tikz">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">color2tikz</span><span class="p">(</span><span class="n">color</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a Color object to a TikZ color string.</span>

<span class="sd">    Args:</span>
<span class="sd">        color (Color): The color object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The TikZ color string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># \usepackage{xcolor}</span>
    <span class="c1"># \tikz\node[rounded corners, fill={rgb,255:red,21; green,66; blue,128},</span>
    <span class="c1">#                                    text=white, draw=black] {hello world};</span>
    <span class="c1"># \definecolor{mycolor}{rgb}{1,0.2,0.3}</span>
    <span class="c1"># \definecolor{mycolor}{R_g_b}{255,51,76}</span>
    <span class="c1"># \definecolor{mypink1}{rgb}{0.858, 0.188, 0.478}</span>
    <span class="c1"># \definecolor{mypink2}{R_g_b}{219, 48, 122}</span>
    <span class="c1"># \definecolor{mypink3}{cmyk}{0, 0.7808, 0.4429, 0.1412}</span>
    <span class="c1"># \definecolor{mygray}{gray}{0.6}</span>
    <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">{{</span><span class="s2">rgb,255:red,</span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s2">; green,</span><span class="si">{</span><span class="n">g</span><span class="si">}</span><span class="s2">; blue,</span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="se">}}</span><span class="s2">&quot;</span>
    <span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">color</span><span class="o">.</span><span class="n">rgb255</span>

    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">{{</span><span class="s2">rgb,255:red,</span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s2">; green,</span><span class="si">{</span><span class="n">g</span><span class="si">}</span><span class="s2">; blue,</span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="se">}}</span><span class="s2">&quot;</span></div>



<div class="viewcode-block" id="get_scope_options">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.get_scope_options">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_scope_options</span><span class="p">(</span><span class="n">item</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Canvas&quot;</span><span class="p">,</span> <span class="s2">&quot;Sketch&quot;</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Used for creating namespaces in TikZ.</span>

<span class="sd">    Args:</span>
<span class="sd">        item (Union[&quot;Canvas&quot;, &quot;Sketch&quot;]): The item to get scope options for.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The scope options as a string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">blend_group</span><span class="p">:</span>
        <span class="n">options</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;blend group=</span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">blend_mode</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">item</span><span class="o">.</span><span class="n">blend_mode</span><span class="p">:</span>
        <span class="n">options</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;blend mode=</span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">blend_mode</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">fill_alpha</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
        <span class="n">options</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;fill opacity=</span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">fill_alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">line_alpha</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
        <span class="n">options</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;draw opacity=</span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">line_alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">text_alpha</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
        <span class="n">options</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;text opacity=</span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">alpha</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
        <span class="n">options</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;opacity=</span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">alpha</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">even_odd_rule</span><span class="p">:</span>
        <span class="n">options</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;even odd rule&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">transparency_group</span><span class="p">:</span>
        <span class="n">options</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;transparency group&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">options</span><span class="p">)</span></div>



<div class="viewcode-block" id="get_clip_code">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.get_clip_code">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_clip_code</span><span class="p">(</span><span class="n">item</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Sketch&quot;</span><span class="p">,</span> <span class="s2">&quot;Canvas&quot;</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the clip code for a sketch or Canvas.</span>

<span class="sd">    Args:</span>
<span class="sd">        item (Union[&quot;Sketch&quot;, &quot;Canvas&quot;]): The item to get clip code for.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The clip code as a string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">subtype</span> <span class="o">==</span> <span class="n">Types</span><span class="o">.</span><span class="n">CIRCLE</span><span class="p">:</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">center</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">res</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">clip(</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s2">) circle (</span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">radius</span><span class="si">}</span><span class="s2">);</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="k">elif</span> <span class="n">item</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">subtype</span> <span class="o">==</span> <span class="n">Types</span><span class="o">.</span><span class="n">RECTANGLE</span><span class="p">:</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">center</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">height</span>
        <span class="n">res</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">clip(</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s2">) rectangle (</span><span class="si">{</span><span class="n">width</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">height</span><span class="si">}</span><span class="s2">);</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="k">elif</span> <span class="n">item</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">subtype</span> <span class="o">==</span> <span class="n">Types</span><span class="o">.</span><span class="n">SHAPE</span><span class="p">:</span>
        <span class="n">vertices</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">primary_points</span><span class="o">.</span><span class="n">homogen_coords</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">])</span>
        <span class="n">res</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">clip plot[] coordinates </span><span class="se">{{</span><span class="si">{</span><span class="n">coords</span><span class="si">}</span><span class="se">}}</span><span class="s2">;</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">return</span> <span class="n">res</span></div>



<div class="viewcode-block" id="get_canvas_scope">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.get_canvas_scope">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_canvas_scope</span><span class="p">(</span><span class="n">canvas</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the TikZ code for the canvas scope.</span>

<span class="sd">    Args:</span>
<span class="sd">        canvas: The canvas object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The TikZ code for the canvas scope.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span> <span class="o">=</span> <span class="n">get_scope_options</span><span class="p">(</span><span class="n">canvas</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">begin</span><span class="se">{{</span><span class="s2">scope</span><span class="se">}}</span><span class="s2">[</span><span class="si">{</span><span class="n">options</span><span class="si">}</span><span class="s2">]</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">canvas</span><span class="o">.</span><span class="n">clip</span> <span class="ow">and</span> <span class="n">canvas</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span> <span class="ow">or</span> <span class="n">canvas</span><span class="o">.</span><span class="n">size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="n">get_clip_code</span><span class="p">(</span><span class="n">canvas</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">res</span></div>



<div class="viewcode-block" id="draw_batch_sketch">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.draw_batch_sketch">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">draw_batch_sketch</span><span class="p">(</span><span class="n">sketch</span><span class="p">,</span> <span class="n">canvas</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a BatchSketch to TikZ code.</span>

<span class="sd">    Args:</span>
<span class="sd">        sketch: The BatchSketch object.</span>
<span class="sd">        canvas: The canvas object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The TikZ code for the BatchSketch.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span> <span class="o">=</span> <span class="n">get_scope_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">options</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">begin</span><span class="se">{{</span><span class="s2">scope</span><span class="se">}}</span><span class="s2">[</span><span class="si">{</span><span class="n">options</span><span class="si">}</span><span class="s2">]</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">clip</span> <span class="ow">and</span> <span class="n">sketch</span><span class="o">.</span><span class="n">mask</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="n">get_clip_code</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sketch</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">subtype</span> <span class="ow">in</span> <span class="n">d_sketch_draw</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">+=</span> <span class="n">d_sketch_draw</span><span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="n">subtype</span><span class="p">](</span><span class="n">item</span><span class="p">,</span> <span class="n">canvas</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sketch type </span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">subtype</span><span class="si">}</span><span class="s2"> not supported.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">clip</span> <span class="ow">and</span> <span class="n">sketch</span><span class="o">.</span><span class="n">mask</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="n">get_clip_code</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">options</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">end</span><span class="si">{scope}</span><span class="se">\n</span><span class="s2">&quot;</span>

    <span class="k">return</span> <span class="n">res</span></div>


<div class="viewcode-block" id="draw_bbox_sketch">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.draw_bbox_sketch">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">draw_bbox_sketch</span><span class="p">(</span><span class="n">sketch</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a BBoxSketch to TikZ code.</span>

<span class="sd">    Args:</span>
<span class="sd">        sketch: The BBoxSketch object.</span>
<span class="sd">        canvas: The canvas object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The TikZ code for the BBoxSketch.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">attrib_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;line_color&quot;</span><span class="p">:</span> <span class="s2">&quot;color&quot;</span><span class="p">,</span>
        <span class="s2">&quot;line_width&quot;</span><span class="p">:</span> <span class="s2">&quot;line width&quot;</span><span class="p">,</span>
        <span class="s2">&quot;line_dash_array&quot;</span><span class="p">:</span> <span class="s2">&quot;dash pattern&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">attrib_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;line_color&quot;</span><span class="p">,</span> <span class="s2">&quot;line_width&quot;</span><span class="p">,</span> <span class="s2">&quot;line_dash_array&quot;</span><span class="p">]</span>
    <span class="n">options</span> <span class="o">=</span> <span class="n">sg_to_tikz</span><span class="p">(</span><span class="n">sketch</span><span class="p">,</span> <span class="n">attrib_list</span><span class="p">,</span> <span class="n">attrib_map</span><span class="p">)</span>
    <span class="n">options</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">draw[</span><span class="si">{</span><span class="n">options</span><span class="si">}</span><span class="s2">]&quot;</span>
    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">res</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">x1</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">y1</span><span class="si">}</span><span class="s2">) rectangle (</span><span class="si">{</span><span class="n">x2</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">y2</span><span class="si">}</span><span class="s2">);</span><span class="se">\n</span><span class="s2">&quot;</span>

    <span class="k">return</span> <span class="n">res</span></div>


<div class="viewcode-block" id="draw_lace_sketch">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.draw_lace_sketch">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">draw_lace_sketch</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a LaceSketch to TikZ code.</span>

<span class="sd">    Args:</span>
<span class="sd">        item: The LaceSketch object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The TikZ code for the LaceSketch.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">draw_fragments</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">fragment</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">fragments</span><span class="p">:</span>
            <span class="n">draw_shape_sketch</span><span class="p">(</span><span class="n">fragment</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">draw_plaits</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">plait</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">plaits</span><span class="p">:</span>
            <span class="n">plait</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">draw_shape_sketch</span><span class="p">(</span><span class="n">plait</span><span class="p">)</span></div>



<div class="viewcode-block" id="get_draw">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.get_draw">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_draw</span><span class="p">(</span><span class="n">sketch</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the draw command for sketches.</span>

<span class="sd">    Args:</span>
<span class="sd">        sketch: The sketch object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The draw command as a string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># sketch.closed, sketch.fill, sketch.stroke, shading</span>
    <span class="n">decision_table</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">shadedraw&quot;</span><span class="p">,</span>
        <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">filldraw&quot;</span><span class="p">,</span>
        <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">shade&quot;</span><span class="p">,</span>
        <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">fill&quot;</span><span class="p">,</span>
        <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">draw&quot;</span><span class="p">,</span>
        <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">draw&quot;</span><span class="p">,</span>
        <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span> <span class="kc">False</span><span class="p">,</span>
        <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span> <span class="kc">False</span><span class="p">,</span>
        <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">draw&quot;</span><span class="p">,</span>
        <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">draw&quot;</span><span class="p">,</span>
        <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span> <span class="kc">False</span><span class="p">,</span>
        <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span> <span class="kc">False</span><span class="p">,</span>
        <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">draw&quot;</span><span class="p">,</span>
        <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">draw&quot;</span><span class="p">,</span>
        <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span> <span class="kc">False</span><span class="p">,</span>
        <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">markers_only</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">draw&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sketch</span><span class="p">,</span> <span class="s1">&#39;back_style&#39;</span><span class="p">):</span>
            <span class="n">shading</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">back_style</span> <span class="o">==</span> <span class="n">BackStyle</span><span class="o">.</span><span class="n">SHADING</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">shading</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sketch</span><span class="p">,</span> <span class="s1">&#39;closed&#39;</span><span class="p">):</span>
            <span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">closed</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">closed</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sketch</span><span class="p">,</span> <span class="s1">&#39;fill&#39;</span><span class="p">):</span>
            <span class="n">fill</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fill</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">fill</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sketch</span><span class="p">,</span> <span class="s1">&#39;stroke&#39;</span><span class="p">):</span>
            <span class="n">stroke</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">stroke</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">stroke</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">decision_table</span><span class="p">[(</span><span class="n">closed</span><span class="p">,</span> <span class="n">fill</span><span class="p">,</span> <span class="n">stroke</span><span class="p">,</span> <span class="n">shading</span><span class="p">)]</span>

    <span class="k">return</span> <span class="n">res</span></div>



<div class="viewcode-block" id="get_frame_options">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.get_frame_options">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_frame_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the options for the frame of a TagSketch.</span>

<span class="sd">    Args:</span>
<span class="sd">        sketch: The TagSketch object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: The options for the frame of the TagSketch.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span> <span class="o">=</span> <span class="n">get_line_style_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="n">options</span> <span class="o">+=</span> <span class="n">get_fill_style_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">text</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">frame_shape</span> <span class="o">==</span> <span class="s2">&quot;rectangle&quot;</span><span class="p">:</span>
            <span class="n">width</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">min_width</span>
            <span class="n">height</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">min_height</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">width</span><span class="p">:</span>
                <span class="n">width</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;min_width&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">height</span><span class="p">:</span>
                <span class="n">height</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;min_height&quot;</span><span class="p">]</span>
            <span class="n">options</span> <span class="o">+=</span> <span class="s2">&quot;minimum width = </span><span class="si">{width}</span><span class="s2">, minimum height = </span><span class="si">{height}</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">size</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">min_size</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">size</span><span class="p">:</span>
                <span class="n">size</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;min_size&quot;</span><span class="p">]</span>
            <span class="n">options</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;minimum size = </span><span class="si">{</span><span class="n">size</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="n">options</span></div>



<div class="viewcode-block" id="draw_tag_sketch">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.draw_tag_sketch">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">draw_tag_sketch</span><span class="p">(</span><span class="n">sketch</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a TagSketch to TikZ code.</span>

<span class="sd">    Args:</span>
<span class="sd">        sketch: The TagSketch object.</span>
<span class="sd">        canvas: The canvas object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The TikZ code for the TagSketch.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># \node at (0,0) {some text};</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_font_family</span><span class="p">(</span><span class="n">sketch</span><span class="p">):</span>
        <span class="n">default_fonts</span> <span class="o">=</span> <span class="p">[</span><span class="n">defaults</span><span class="p">[</span><span class="s1">&#39;main_font&#39;</span><span class="p">],</span> <span class="n">defaults</span><span class="p">[</span><span class="s1">&#39;sans_font&#39;</span><span class="p">],</span> <span class="n">defaults</span><span class="p">[</span><span class="s1">&#39;mono_font&#39;</span><span class="p">]]</span>

        <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">font_family</span> <span class="ow">in</span> <span class="n">default_fonts</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">font_family</span> <span class="o">==</span> <span class="n">defaults</span><span class="p">[</span><span class="s1">&#39;main_font&#39;</span><span class="p">]:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="s1">&#39;tex_family&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span>
            <span class="k">elif</span> <span class="n">sketch</span><span class="o">.</span><span class="n">font_family</span> <span class="o">==</span> <span class="n">defaults</span><span class="p">[</span><span class="s1">&#39;sans_font&#39;</span><span class="p">]:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="s1">&#39;tex_family&#39;</span><span class="p">,</span> <span class="s1">&#39;textsf&#39;</span>
            <span class="k">else</span><span class="p">:</span> <span class="c1"># defaults[&#39;mono_font&#39;]</span>
                <span class="n">res</span> <span class="o">=</span> <span class="s1">&#39;tex_family&#39;</span><span class="p">,</span> <span class="s1">&#39;texttt&#39;</span>
        <span class="k">elif</span> <span class="n">sketch</span><span class="o">.</span><span class="n">font_family</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sketch</span><span class="o">.</span><span class="n">font_family</span><span class="p">,</span> <span class="n">FontFamily</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">font_family</span> <span class="o">==</span> <span class="n">FontFamily</span><span class="o">.</span><span class="n">SANSSERIF</span><span class="p">:</span>
                    <span class="n">res</span> <span class="o">=</span> <span class="s1">&#39;tex_family&#39;</span><span class="p">,</span> <span class="s1">&#39;textsf&#39;</span>
                <span class="k">elif</span> <span class="n">sketch</span><span class="o">.</span><span class="n">font_family</span> <span class="o">==</span> <span class="n">FontFamily</span><span class="o">.</span><span class="n">MONOSPACE</span><span class="p">:</span>
                    <span class="n">res</span> <span class="o">=</span> <span class="s1">&#39;tex_family&#39;</span><span class="p">,</span> <span class="s1">&#39;texttt&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">res</span> <span class="o">=</span> <span class="s1">&#39;tex_family&#39;</span><span class="p">,</span> <span class="s1">&#39;textrm&#39;</span>

            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sketch</span><span class="o">.</span><span class="n">font_family</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">res</span> <span class="o">=</span> <span class="s1">&#39;new_family&#39;</span><span class="p">,</span> <span class="n">sketch</span><span class="o">.</span><span class="n">font_family</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Font family </span><span class="si">{</span><span class="n">sketch</span><span class="o">.</span><span class="n">font_family</span><span class="si">}</span><span class="s2"> not supported.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="s1">&#39;no_family&#39;</span><span class="p">,</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">res</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_font_size</span><span class="p">(</span><span class="n">sketch</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">font_size</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sketch</span><span class="o">.</span><span class="n">font_size</span><span class="p">,</span> <span class="n">FontSize</span><span class="p">):</span>
                <span class="n">res</span> <span class="o">=</span> <span class="s1">&#39;tex_size&#39;</span><span class="p">,</span> <span class="n">sketch</span><span class="o">.</span><span class="n">font_size</span><span class="o">.</span><span class="n">value</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="s1">&#39;num_size&#39;</span><span class="p">,</span> <span class="n">sketch</span><span class="o">.</span><span class="n">font_size</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="s1">&#39;no_size&#39;</span><span class="p">,</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">res</span>


    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">pos</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>

    <span class="n">options</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">draw_frame</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">+=</span> <span class="s2">&quot;draw&quot;</span>
        <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">stroke</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">frame_shape</span> <span class="o">!=</span> <span class="n">FrameShape</span><span class="o">.</span><span class="n">RECTANGLE</span><span class="p">:</span>
                <span class="n">options</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, </span><span class="si">{</span><span class="n">sketch</span><span class="o">.</span><span class="n">frame_shape</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">line_style_options</span> <span class="o">=</span> <span class="n">get_line_style_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">line_style_options</span><span class="p">:</span>
                <span class="n">options</span> <span class="o">+=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">line_style_options</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">frame_inner_sep</span><span class="p">:</span>
                <span class="n">options</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, inner sep=</span><span class="si">{</span><span class="n">sketch</span><span class="o">.</span><span class="n">frame_inner_sep</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">minimum_width</span><span class="p">:</span>
                <span class="n">options</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, minimum width=</span><span class="si">{</span><span class="n">sketch</span><span class="o">.</span><span class="n">minimum_width</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">smooth</span> <span class="ow">and</span> <span class="n">sketch</span><span class="o">.</span><span class="n">frame_shape</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
                <span class="n">FrameShape</span><span class="o">.</span><span class="n">CIRCLE</span><span class="p">,</span>
                <span class="n">FrameShape</span><span class="o">.</span><span class="n">ELLIPSE</span><span class="p">,</span>
            <span class="p">]:</span>
                <span class="n">options</span> <span class="o">+=</span> <span class="s2">&quot;, smooth&quot;</span>

    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">fill</span> <span class="ow">and</span> <span class="n">sketch</span><span class="o">.</span><span class="n">back_color</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, fill=</span><span class="si">{</span><span class="n">color2tikz</span><span class="p">(</span><span class="n">sketch</span><span class="o">.</span><span class="n">frame_back_color</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">anchor</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, anchor=</span><span class="si">{</span><span class="n">sketch</span><span class="o">.</span><span class="n">anchor</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">back_style</span> <span class="o">==</span> <span class="n">BackStyle</span><span class="o">.</span><span class="n">SHADING</span> <span class="ow">and</span> <span class="n">sketch</span><span class="o">.</span><span class="n">fill</span><span class="p">:</span>
        <span class="n">shading_options</span> <span class="o">=</span> <span class="n">get_shading_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">options</span> <span class="o">+=</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="n">shading_options</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">back_style</span> <span class="o">==</span> <span class="n">BackStyle</span><span class="o">.</span><span class="n">PATTERN</span> <span class="ow">and</span> <span class="n">sketch</span><span class="o">.</span><span class="n">fill</span><span class="p">:</span>
        <span class="n">pattern_options</span> <span class="o">=</span> <span class="n">get_pattern_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">options</span> <span class="o">+=</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="n">pattern_options</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">align</span> <span class="o">!=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;tag_align&quot;</span><span class="p">]:</span>
        <span class="n">options</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, align=</span><span class="si">{</span><span class="n">sketch</span><span class="o">.</span><span class="n">align</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">text_width</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, text width=</span><span class="si">{</span><span class="n">sketch</span><span class="o">.</span><span class="n">text_width</span><span class="si">}</span><span class="s2">&quot;</span>


<span class="c1"># no_family, tex_family, new_family</span>
<span class="c1"># no_size, tex_size, num_size</span>

<span class="c1"># num_size and new_family {\fontsize{20}{24} \selectfont \Verdana ABCDEFG Hello, World! 25}</span>
<span class="c1"># tex_size and new_family {\large{\selectfont \Verdana ABCDEFG Hello, World! 50}}</span>
<span class="c1"># no_size and new_family {\selectfont \Verdana ABCDEFG Hello, World! 50}</span>

<span class="c1"># tex_family {\textsc{\textit{\textbf{\Huge{\texttt{ABCDG Just a test -50}}}}}};</span>

<span class="c1"># no_family {\textsc{\textit{\textbf{\Huge{ABCDG Just a test -50}}}}};</span>

    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">font_color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">sketch</span><span class="o">.</span><span class="n">font_color</span> <span class="o">!=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;font_color&quot;</span><span class="p">]:</span>
        <span class="n">options</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, text=</span><span class="si">{</span><span class="n">color2tikz</span><span class="p">(</span><span class="n">sketch</span><span class="o">.</span><span class="n">font_color</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">family</span><span class="p">,</span> <span class="n">font_family</span> <span class="o">=</span> <span class="n">get_font_family</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="n">size</span><span class="p">,</span> <span class="n">font_size</span> <span class="o">=</span> <span class="n">get_font_size</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="n">tex_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">small_caps</span><span class="p">:</span>
        <span class="n">tex_text</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">textsc{&#39;</span>

    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">italic</span><span class="p">:</span>
        <span class="n">tex_text</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">textit{&#39;</span>

    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">bold</span><span class="p">:</span>
        <span class="n">tex_text</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">textbf{&#39;</span>

    <span class="k">if</span> <span class="n">size</span> <span class="o">==</span> <span class="s1">&#39;num_size&#39;</span><span class="p">:</span>
        <span class="n">f_size</span> <span class="o">=</span> <span class="n">font_size</span>
        <span class="n">f_size2</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">font_size</span> <span class="o">*</span> <span class="mf">1.2</span><span class="p">)</span>
        <span class="n">tex_text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">fontsize</span><span class="se">{{</span><span class="si">{</span><span class="n">f_size</span><span class="si">}</span><span class="se">}}{{</span><span class="si">{</span><span class="n">f_size2</span><span class="si">}</span><span class="se">}}\\</span><span class="s2">selectfont &quot;</span>

    <span class="k">elif</span> <span class="n">size</span> <span class="o">==</span> <span class="s1">&#39;tex_size&#39;</span><span class="p">:</span>
        <span class="n">tex_text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="si">{</span><span class="n">font_size</span><span class="si">}</span><span class="se">{{\\</span><span class="s2">selectfont &quot;</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">tex_text</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">selectfont &quot;</span>

    <span class="k">if</span> <span class="n">family</span> <span class="o">==</span> <span class="s1">&#39;new_family&#39;</span><span class="p">:</span>
        <span class="n">tex_text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="si">{</span><span class="n">font_family</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">sketch</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="se">}}</span><span class="s2">&quot;</span>

    <span class="k">elif</span> <span class="n">family</span> <span class="o">==</span> <span class="s1">&#39;tex_family&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">font_family</span><span class="p">:</span>
            <span class="n">tex_text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="si">{</span><span class="n">font_family</span><span class="si">}</span><span class="se">{{</span><span class="s2"> </span><span class="si">{</span><span class="n">sketch</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="se">}}}}</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tex_text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">{{</span><span class="s2"> </span><span class="si">{</span><span class="n">sketch</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="se">}}</span><span class="s2">&quot;</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1"># no_family</span>
        <span class="n">tex_text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">{{</span><span class="s2"> </span><span class="si">{</span><span class="n">sketch</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="se">}}</span><span class="s2">&quot;</span>

    <span class="n">tex_text</span> <span class="o">=</span> <span class="s1">&#39;{&#39;</span> <span class="o">+</span> <span class="n">tex_text</span>

    <span class="n">open_braces</span> <span class="o">=</span> <span class="n">tex_text</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;{&#39;</span><span class="p">)</span>
    <span class="n">close_braces</span> <span class="o">=</span> <span class="n">tex_text</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;}&#39;</span><span class="p">)</span>
    <span class="n">tex_text</span> <span class="o">=</span> <span class="n">tex_text</span> <span class="o">+</span> <span class="s1">&#39;}&#39;</span> <span class="o">*</span> <span class="p">(</span><span class="n">open_braces</span> <span class="o">-</span> <span class="n">close_braces</span><span class="p">)</span>

    <span class="n">res</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">node[</span><span class="si">{</span><span class="n">options</span><span class="si">}</span><span class="s2">] at (</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s2">) </span><span class="si">{</span><span class="n">tex_text</span><span class="si">}</span><span class="s2">;</span><span class="se">\n</span><span class="s2">&quot;</span>

    <span class="k">return</span> <span class="n">res</span></div>



<div class="viewcode-block" id="get_dash_pattern">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.get_dash_pattern">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_dash_pattern</span><span class="p">(</span><span class="n">line_dash_array</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the dash pattern for a line.</span>

<span class="sd">    Args:</span>
<span class="sd">        line_dash_array: The dash array for the line.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The dash pattern as a string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dash_pattern</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">dash</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">line_dash_array</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">dash_pattern</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;on&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dash</span><span class="si">}</span><span class="s2">pt&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dash_pattern</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;off&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dash</span><span class="si">}</span><span class="s2">pt&quot;</span><span class="p">])</span>

    <span class="k">return</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dash_pattern</span><span class="p">)</span></div>



<div class="viewcode-block" id="sg_to_tikz">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.sg_to_tikz">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">sg_to_tikz</span><span class="p">(</span><span class="n">sketch</span><span class="p">,</span> <span class="n">attrib_list</span><span class="p">,</span> <span class="n">attrib_map</span><span class="p">,</span> <span class="n">conditions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exceptions</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts the attributes of a sketch to TikZ options.</span>

<span class="sd">    Args:</span>
<span class="sd">        sketch: The sketch object.</span>
<span class="sd">        attrib_list: The list of attributes to convert.</span>
<span class="sd">        attrib_map: The map of attributes to TikZ options.</span>
<span class="sd">        conditions: Optional conditions for the attributes.</span>
<span class="sd">        exceptions: Optional exceptions for the attributes.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: The TikZ options as a list.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">skip</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;marker_color&quot;</span><span class="p">,</span> <span class="s2">&quot;fill_color&quot;</span><span class="p">]</span>
    <span class="n">tikz_way</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;line_width&#39;</span><span class="p">:</span><span class="n">LineWidth</span><span class="p">,</span> <span class="s1">&#39;line_dash_array&#39;</span><span class="p">:</span><span class="n">LineDashArray</span><span class="p">}</span>
    <span class="k">if</span> <span class="n">exceptions</span><span class="p">:</span>
        <span class="n">skip</span> <span class="o">+=</span> <span class="n">exceptions</span>
    <span class="n">d_converters</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;line_color&quot;</span><span class="p">:</span> <span class="n">color2tikz</span><span class="p">,</span>
        <span class="s2">&quot;fill_color&quot;</span><span class="p">:</span> <span class="n">color2tikz</span><span class="p">,</span>
        <span class="s2">&quot;draw&quot;</span><span class="p">:</span> <span class="n">color2tikz</span><span class="p">,</span>
        <span class="s2">&quot;line_dash_array&quot;</span><span class="p">:</span> <span class="n">get_dash_pattern</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">options</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">attrib</span> <span class="ow">in</span> <span class="n">attrib_list</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">attrib</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">attrib_map</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">conditions</span> <span class="ow">and</span> <span class="n">attrib</span> <span class="ow">in</span> <span class="n">conditions</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">conditions</span><span class="p">[</span><span class="n">attrib</span><span class="p">]:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">attrib</span> <span class="ow">in</span> <span class="n">tikz_way</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sketch</span><span class="p">,</span> <span class="n">attrib</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">tikz_way</span><span class="p">[</span><span class="n">attrib</span><span class="p">]):</span>
                <span class="n">option</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">value</span>
                <span class="n">options</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">tikz_way</span><span class="p">[</span><span class="n">attrib</span><span class="p">]:</span>
                    <span class="n">options</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="k">continue</span>

        <span class="n">tikz_attrib</span> <span class="o">=</span> <span class="n">attrib_map</span><span class="p">[</span><span class="n">attrib</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sketch</span><span class="p">,</span> <span class="n">attrib</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sketch</span><span class="p">,</span> <span class="n">attrib</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">tikz_attrib</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">attrib_map</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
                <span class="k">if</span> <span class="n">attrib</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;smooth&#39;</span><span class="p">]:</span> <span class="c1"># smooth is a boolean</span>
                    <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
                        <span class="n">options</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;smooth&quot;</span><span class="p">)</span>

                <span class="k">elif</span> <span class="n">attrib</span> <span class="ow">in</span> <span class="n">skip</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">color2tikz</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">sketch</span><span class="p">,</span> <span class="n">attrib</span><span class="p">))</span>
                    <span class="n">options</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tikz_attrib</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="k">elif</span> <span class="n">value</span> <span class="o">!=</span> <span class="n">tikz_defaults</span><span class="p">[</span><span class="n">tikz_attrib</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">attrib</span> <span class="ow">in</span> <span class="n">d_converters</span><span class="p">:</span>
                        <span class="n">value</span> <span class="o">=</span> <span class="n">d_converters</span><span class="p">[</span><span class="n">attrib</span><span class="p">](</span><span class="n">value</span><span class="p">)</span>
                    <span class="n">options</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tikz_attrib</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">options</span></div>



<div class="viewcode-block" id="get_line_style_options">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.get_line_style_options">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_line_style_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">,</span> <span class="n">exceptions</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the options for the line style.</span>

<span class="sd">    Args:</span>
<span class="sd">        sketch: The sketch object.</span>
<span class="sd">        exceptions: Optional exceptions for the line style options.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: The line style options as a list.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">attrib_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;line_color&quot;</span><span class="p">:</span> <span class="s2">&quot;color&quot;</span><span class="p">,</span>
        <span class="s2">&quot;line_width&quot;</span><span class="p">:</span> <span class="s2">&quot;line width&quot;</span><span class="p">,</span>
        <span class="s2">&quot;line_dash_array&quot;</span><span class="p">:</span> <span class="s2">&quot;dash pattern&quot;</span><span class="p">,</span>
        <span class="s2">&quot;line_cap&quot;</span><span class="p">:</span> <span class="s2">&quot;line cap&quot;</span><span class="p">,</span>
        <span class="s2">&quot;line_join&quot;</span><span class="p">:</span> <span class="s2">&quot;line join&quot;</span><span class="p">,</span>
        <span class="s2">&quot;line_miter_limit&quot;</span><span class="p">:</span> <span class="s2">&quot;miter limit&quot;</span><span class="p">,</span>
        <span class="s2">&quot;line_dash_phase&quot;</span><span class="p">:</span> <span class="s2">&quot;dash phase&quot;</span><span class="p">,</span>
        <span class="s2">&quot;line_alpha&quot;</span><span class="p">:</span> <span class="s2">&quot;draw opacity&quot;</span><span class="p">,</span>
        <span class="s2">&quot;smooth&quot;</span><span class="p">:</span> <span class="s2">&quot;smooth&quot;</span><span class="p">,</span>
        <span class="s2">&quot;fillet_radius&quot;</span><span class="p">:</span> <span class="s2">&quot;rounded corners&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">attribs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">line_style_map</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">stroke</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">exceptions</span> <span class="ow">and</span> <span class="s2">&quot;draw_fillets&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exceptions</span><span class="p">:</span>
            <span class="n">conditions</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;fillet_radius&quot;</span><span class="p">:</span> <span class="n">sketch</span><span class="o">.</span><span class="n">draw_fillets</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">conditions</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">line_alpha</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
            <span class="n">sketch</span><span class="o">.</span><span class="n">line_alpha</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">line_alpha</span>
        <span class="k">elif</span> <span class="n">sketch</span><span class="o">.</span><span class="n">alpha</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
            <span class="n">sketch</span><span class="o">.</span><span class="n">fill_alpha</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">alpha</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">attribs</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;line_alpha&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">sketch</span><span class="o">.</span><span class="n">smooth</span><span class="p">:</span>
            <span class="n">attribs</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;smooth&quot;</span><span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">sg_to_tikz</span><span class="p">(</span><span class="n">sketch</span><span class="p">,</span> <span class="n">attribs</span><span class="p">,</span> <span class="n">attrib_map</span><span class="p">,</span> <span class="n">conditions</span><span class="p">,</span> <span class="n">exceptions</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">return</span> <span class="n">res</span></div>



<div class="viewcode-block" id="get_fill_style_options">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.get_fill_style_options">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_fill_style_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">,</span> <span class="n">exceptions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the options for the fill style.</span>

<span class="sd">    Args:</span>
<span class="sd">        sketch: The sketch object.</span>
<span class="sd">        exceptions: Optional exceptions for the fill style options.</span>
<span class="sd">        frame: Optional flag for frame fill style.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: The fill style options as a list.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">attrib_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;fill_color&quot;</span><span class="p">:</span> <span class="s2">&quot;fill&quot;</span><span class="p">,</span>
        <span class="s2">&quot;fill_alpha&quot;</span><span class="p">:</span> <span class="s2">&quot;fill opacity&quot;</span><span class="p">,</span>
        <span class="c1">#&#39;fill_mode&#39;: &#39;even odd rule&#39;,</span>
        <span class="s2">&quot;blend_mode&quot;</span><span class="p">:</span> <span class="s2">&quot;blend mode&quot;</span><span class="p">,</span>
        <span class="s2">&quot;frame_back_color&quot;</span><span class="p">:</span> <span class="s2">&quot;fill&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">attribs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">shape_style_map</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">fill_alpha</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
        <span class="n">sketch</span><span class="o">.</span><span class="n">fill_alpha</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">fill_alpha</span>
    <span class="k">elif</span> <span class="n">sketch</span><span class="o">.</span><span class="n">alpha</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
        <span class="n">sketch</span><span class="o">.</span><span class="n">fill_alpha</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">alpha</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">attribs</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;fill_alpha&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">fill</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">sketch</span><span class="o">.</span><span class="n">back_style</span> <span class="o">==</span> <span class="n">BackStyle</span><span class="o">.</span><span class="n">PATTERN</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">sg_to_tikz</span><span class="p">(</span><span class="n">sketch</span><span class="p">,</span> <span class="n">attribs</span><span class="p">,</span> <span class="n">attrib_map</span><span class="p">,</span> <span class="n">exceptions</span><span class="o">=</span><span class="n">exceptions</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">frame</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;fill = </span><span class="si">{</span><span class="n">color2tikz</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">sketch</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;frame_back_color&#39;</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">res</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">return</span> <span class="n">res</span></div>



<div class="viewcode-block" id="get_axis_shading_colors">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.get_axis_shading_colors">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_axis_shading_colors</span><span class="p">(</span><span class="n">sketch</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the shading colors for the axis.</span>

<span class="sd">    Args:</span>
<span class="sd">        sketch: The sketch object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The shading colors for the axis.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_color</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="n">color_key</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="n">Color</span><span class="p">):</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">color2tikz</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="n">color_key</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">res</span>

    <span class="n">left</span> <span class="o">=</span> <span class="n">get_color</span><span class="p">(</span><span class="n">sketch</span><span class="o">.</span><span class="n">shade_left_color</span><span class="p">,</span> <span class="s2">&quot;shade_left_color&quot;</span><span class="p">)</span>
    <span class="n">right</span> <span class="o">=</span> <span class="n">get_color</span><span class="p">(</span><span class="n">sketch</span><span class="o">.</span><span class="n">shade_right_color</span><span class="p">,</span> <span class="s2">&quot;shade_right_color&quot;</span><span class="p">)</span>
    <span class="n">top</span> <span class="o">=</span> <span class="n">get_color</span><span class="p">(</span><span class="n">sketch</span><span class="o">.</span><span class="n">shade_top_color</span><span class="p">,</span> <span class="s2">&quot;shade_top_color&quot;</span><span class="p">)</span>
    <span class="n">bottom</span> <span class="o">=</span> <span class="n">get_color</span><span class="p">(</span><span class="n">sketch</span><span class="o">.</span><span class="n">shade_bottom_color</span><span class="p">,</span> <span class="s2">&quot;shade_bottom_color&quot;</span><span class="p">)</span>
    <span class="n">middle</span> <span class="o">=</span> <span class="n">get_color</span><span class="p">(</span><span class="n">sketch</span><span class="o">.</span><span class="n">shade_middle_color</span><span class="p">,</span> <span class="s2">&quot;shade_middle_color&quot;</span><span class="p">)</span>

    <span class="n">axis_colors</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">ShadeType</span><span class="o">.</span><span class="n">AXIS_BOTTOM_MIDDLE</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;bottom color=</span><span class="si">{</span><span class="n">bottom</span><span class="si">}</span><span class="s2">, middle color=</span><span class="si">{</span><span class="n">middle</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">ShadeType</span><span class="o">.</span><span class="n">AXIS_LEFT_MIDDLE</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;left color=</span><span class="si">{</span><span class="n">left</span><span class="si">}</span><span class="s2">, middle color=</span><span class="si">{</span><span class="n">middle</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">ShadeType</span><span class="o">.</span><span class="n">AXIS_RIGHT_MIDDLE</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;right color=</span><span class="si">{</span><span class="n">right</span><span class="si">}</span><span class="s2">, middle color=</span><span class="si">{</span><span class="n">middle</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">ShadeType</span><span class="o">.</span><span class="n">AXIS_TOP_MIDDLE</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;top color=</span><span class="si">{</span><span class="n">top</span><span class="si">}</span><span class="s2">, middle color=</span><span class="si">{</span><span class="n">middle</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">ShadeType</span><span class="o">.</span><span class="n">AXIS_LEFT_RIGHT</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;left color=</span><span class="si">{</span><span class="n">left</span><span class="si">}</span><span class="s2">, right color=</span><span class="si">{</span><span class="n">right</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">ShadeType</span><span class="o">.</span><span class="n">AXIS_TOP_BOTTOM</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;top color=</span><span class="si">{</span><span class="n">top</span><span class="si">}</span><span class="s2">, bottom color=</span><span class="si">{</span><span class="n">bottom</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">res</span> <span class="o">=</span> <span class="n">axis_colors</span><span class="p">[</span><span class="n">sketch</span><span class="o">.</span><span class="n">shade_type</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">res</span></div>



<div class="viewcode-block" id="get_bilinear_shading_colors">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.get_bilinear_shading_colors">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_bilinear_shading_colors</span><span class="p">(</span><span class="n">sketch</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the shading colors for the bilinear shading.</span>

<span class="sd">    Args:</span>
<span class="sd">        sketch: The sketch object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The shading colors for the bilinear shading.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">shade_upper_left_color</span><span class="p">:</span>
        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;upper left = </span><span class="si">{</span><span class="n">color2tikz</span><span class="p">(</span><span class="n">sketch</span><span class="o">.</span><span class="n">shade_upper_left_color</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">shade_upper_right_color</span><span class="p">:</span>
        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;upper right = </span><span class="si">{</span><span class="n">color2tikz</span><span class="p">(</span><span class="n">sketch</span><span class="o">.</span><span class="n">shade_upper_right_color</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">shade_lower_left_color</span><span class="p">:</span>
        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;lower left = </span><span class="si">{</span><span class="n">color2tikz</span><span class="p">(</span><span class="n">sketch</span><span class="o">.</span><span class="n">shade_lower_left_color</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">shade_lower_right_color</span><span class="p">:</span>
        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;lower right = </span><span class="si">{</span><span class="n">color2tikz</span><span class="p">(</span><span class="n">sketch</span><span class="o">.</span><span class="n">shade_lower_right_color</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">res</span><span class="p">)</span></div>



<div class="viewcode-block" id="get_radial_shading_colors">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.get_radial_shading_colors">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_radial_shading_colors</span><span class="p">(</span><span class="n">sketch</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the shading colors for the radial shading.</span>

<span class="sd">    Args:</span>
<span class="sd">        sketch: The sketch object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The shading colors for the radial shading.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">shade_type</span> <span class="o">==</span> <span class="n">ShadeType</span><span class="o">.</span><span class="n">RADIAL_INNER</span><span class="p">:</span>
        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;inner color = </span><span class="si">{</span><span class="n">color2tikz</span><span class="p">(</span><span class="n">sketch</span><span class="o">.</span><span class="n">shade_inner_color</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">sketch</span><span class="o">.</span><span class="n">shade_type</span> <span class="o">==</span> <span class="n">ShadeType</span><span class="o">.</span><span class="n">RADIAL_OUTER</span><span class="p">:</span>
        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;outer color = </span><span class="si">{</span><span class="n">color2tikz</span><span class="p">(</span><span class="n">sketch</span><span class="o">.</span><span class="n">shade_outer_color</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">sketch</span><span class="o">.</span><span class="n">shade_type</span> <span class="o">==</span> <span class="n">ShadeType</span><span class="o">.</span><span class="n">RADIAL_INNER_OUTER</span><span class="p">:</span>
        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;inner color = </span><span class="si">{</span><span class="n">color2tikz</span><span class="p">(</span><span class="n">sketch</span><span class="o">.</span><span class="n">shade_inner_color</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;outer color = </span><span class="si">{</span><span class="n">color2tikz</span><span class="p">(</span><span class="n">sketch</span><span class="o">.</span><span class="n">shade_outer_color</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">res</span><span class="p">)</span></div>



<span class="n">axis_shading_types</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">ShadeType</span><span class="o">.</span><span class="n">AXIS_BOTTOM_MIDDLE</span><span class="p">,</span>
    <span class="n">ShadeType</span><span class="o">.</span><span class="n">AXIS_LEFT_MIDDLE</span><span class="p">,</span>
    <span class="n">ShadeType</span><span class="o">.</span><span class="n">AXIS_RIGHT_MIDDLE</span><span class="p">,</span>
    <span class="n">ShadeType</span><span class="o">.</span><span class="n">AXIS_TOP_MIDDLE</span><span class="p">,</span>
    <span class="n">ShadeType</span><span class="o">.</span><span class="n">AXIS_LEFT_RIGHT</span><span class="p">,</span>
    <span class="n">ShadeType</span><span class="o">.</span><span class="n">AXIS_TOP_BOTTOM</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">radial_shading_types</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">ShadeType</span><span class="o">.</span><span class="n">RADIAL_INNER</span><span class="p">,</span>
    <span class="n">ShadeType</span><span class="o">.</span><span class="n">RADIAL_OUTER</span><span class="p">,</span>
    <span class="n">ShadeType</span><span class="o">.</span><span class="n">RADIAL_INNER_OUTER</span><span class="p">,</span>
<span class="p">]</span>


<div class="viewcode-block" id="get_shading_options">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.get_shading_options">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_shading_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the options for the shading.</span>

<span class="sd">    Args:</span>
<span class="sd">        sketch: The sketch object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: The shading options as a list.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">shade_type</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">shade_type</span>
    <span class="k">if</span> <span class="n">shade_type</span> <span class="ow">in</span> <span class="n">axis_shading_types</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">get_axis_shading_colors</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">shade_axis_angle</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, shading angle=</span><span class="si">{</span><span class="n">sketch</span><span class="o">.</span><span class="n">shade_axis_angle</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">elif</span> <span class="n">shade_type</span> <span class="o">==</span> <span class="n">ShadeType</span><span class="o">.</span><span class="n">BILINEAR</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">get_bilinear_shading_colors</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">shade_type</span> <span class="ow">in</span> <span class="n">radial_shading_types</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">get_radial_shading_colors</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">shade_type</span> <span class="o">==</span> <span class="n">ShadeType</span><span class="o">.</span><span class="n">BALL</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ball color = </span><span class="si">{</span><span class="n">color2tikz</span><span class="p">(</span><span class="n">sketch</span><span class="o">.</span><span class="n">shade_ball_color</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">elif</span> <span class="n">shade_type</span> <span class="o">==</span> <span class="n">ShadeType</span><span class="o">.</span><span class="n">COLORWHEEL</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="s2">&quot;shading=color wheel&quot;</span>
    <span class="k">elif</span> <span class="n">shade_type</span> <span class="o">==</span> <span class="n">ShadeType</span><span class="o">.</span><span class="n">COLORWHEEL_BLACK</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="s2">&quot;shading=color wheel black center&quot;</span>
    <span class="k">elif</span> <span class="n">shade_type</span> <span class="o">==</span> <span class="n">ShadeType</span><span class="o">.</span><span class="n">COLORWHEEL_WHITE</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="s2">&quot;shading=color wheel white center&quot;</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">res</span><span class="p">]</span></div>



<div class="viewcode-block" id="get_pattern_options">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.get_pattern_options">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_pattern_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the options for the patterns.</span>

<span class="sd">    Args:</span>
<span class="sd">        sketch: The sketch object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: The pattern options as a list.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pattern_type</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">pattern_type</span>
    <span class="k">if</span> <span class="n">pattern_type</span><span class="p">:</span>
        <span class="n">distance</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">pattern_distance</span>
        <span class="n">options</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;pattern=</span><span class="se">{{</span><span class="si">{</span><span class="n">pattern_type</span><span class="si">}</span><span class="s2">[distance=</span><span class="si">{</span><span class="n">distance</span><span class="si">}</span><span class="s2">, &quot;</span>
        <span class="n">angle</span> <span class="o">=</span> <span class="n">degrees</span><span class="p">(</span><span class="n">sketch</span><span class="o">.</span><span class="n">pattern_angle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">angle</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;angle=</span><span class="si">{</span><span class="n">angle</span><span class="si">}</span><span class="s2">, &quot;</span>
        <span class="n">line_width</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">pattern_line_width</span>
        <span class="k">if</span> <span class="n">line_width</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;line width=</span><span class="si">{</span><span class="n">line_width</span><span class="si">}</span><span class="s2">, &quot;</span>
        <span class="n">x_shift</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">pattern_x_shift</span>
        <span class="k">if</span> <span class="n">x_shift</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;xshift=</span><span class="si">{</span><span class="n">x_shift</span><span class="si">}</span><span class="s2">, &quot;</span>
        <span class="n">y_shift</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">pattern_y_shift</span>
        <span class="k">if</span> <span class="n">y_shift</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;yshift=</span><span class="si">{</span><span class="n">y_shift</span><span class="si">}</span><span class="s2">, &quot;</span>
        <span class="k">if</span> <span class="n">pattern_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Stars&quot;</span><span class="p">,</span> <span class="s2">&quot;Dots&quot;</span><span class="p">]:</span>
            <span class="n">radius</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">pattern_radius</span>
            <span class="k">if</span> <span class="n">radius</span><span class="p">:</span>
                <span class="n">options</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;radius=</span><span class="si">{</span><span class="n">radius</span><span class="si">}</span><span class="s2">, &quot;</span>
            <span class="k">if</span> <span class="n">pattern_type</span> <span class="o">==</span> <span class="s2">&quot;Stars&quot;</span><span class="p">:</span>
                <span class="n">points</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">pattern_points</span>
                <span class="k">if</span> <span class="n">points</span><span class="p">:</span>
                    <span class="n">options</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;points=</span><span class="si">{</span><span class="n">points</span><span class="si">}</span><span class="s2">, &quot;</span>
        <span class="n">options</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">options</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">):</span>
            <span class="n">options</span> <span class="o">=</span> <span class="n">options</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">options</span> <span class="o">+=</span> <span class="s2">&quot;]&quot;</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">pattern_color</span>
        <span class="k">if</span> <span class="n">color</span> <span class="ow">and</span> <span class="n">color</span> <span class="o">!=</span> <span class="n">sg</span><span class="o">.</span><span class="n">black</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, pattern color=</span><span class="si">{</span><span class="n">color2tikz</span><span class="p">(</span><span class="n">color</span><span class="p">)</span><span class="si">}</span><span class="s2">, &quot;</span>

        <span class="n">options</span> <span class="o">+=</span> <span class="s2">&quot;}&quot;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">options</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">return</span> <span class="n">res</span></div>



<div class="viewcode-block" id="get_marker_options">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.get_marker_options">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_marker_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the options for the markers.</span>

<span class="sd">    Args:</span>
<span class="sd">        sketch: The sketch object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: The marker options as a list.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">attrib_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="c1"># &#39;marker&#39;: &#39;mark&#39;,</span>
        <span class="s2">&quot;marker_size&quot;</span><span class="p">:</span> <span class="s2">&quot;mark size&quot;</span><span class="p">,</span>
        <span class="s2">&quot;marker_angle&quot;</span><span class="p">:</span> <span class="s2">&quot;rotate&quot;</span><span class="p">,</span>
        <span class="c1"># &#39;fill_color&#39;: &#39;color&#39;,</span>
        <span class="s2">&quot;marker_color&quot;</span><span class="p">:</span> <span class="s2">&quot;color&quot;</span><span class="p">,</span>
        <span class="s2">&quot;marker_fill&quot;</span><span class="p">:</span> <span class="s2">&quot;fill&quot;</span><span class="p">,</span>
        <span class="s2">&quot;marker_opacity&quot;</span><span class="p">:</span> <span class="s2">&quot;opacity&quot;</span><span class="p">,</span>
        <span class="s2">&quot;marker_repeat&quot;</span><span class="p">:</span> <span class="s2">&quot;mark repeat&quot;</span><span class="p">,</span>
        <span class="s2">&quot;marker_phase&quot;</span><span class="p">:</span> <span class="s2">&quot;mark phase&quot;</span><span class="p">,</span>
        <span class="s2">&quot;marker_tension&quot;</span><span class="p">:</span> <span class="s2">&quot;tension&quot;</span><span class="p">,</span>
        <span class="s2">&quot;marker_line_width&quot;</span><span class="p">:</span> <span class="s2">&quot;line width&quot;</span><span class="p">,</span>
        <span class="s2">&quot;marker_line_style&quot;</span><span class="p">:</span> <span class="s2">&quot;style&quot;</span><span class="p">,</span>
        <span class="c1"># &#39;line_color&#39;: &#39;line color&#39;,</span>
    <span class="p">}</span>
    <span class="c1"># if mark_stroke is false make line color same as fill color</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">draw_markers</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">sg_to_tikz</span><span class="p">(</span><span class="n">sketch</span><span class="p">,</span> <span class="n">marker_style_map</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">attrib_map</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">return</span> <span class="n">res</span></div>



<div class="viewcode-block" id="draw_shape_sketch_with_indices">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.draw_shape_sketch_with_indices">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">draw_shape_sketch_with_indices</span><span class="p">(</span><span class="n">sketch</span><span class="p">,</span> <span class="n">ind</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Draws a shape sketch with circle markers with index numbers in them.</span>

<span class="sd">    Args:</span>
<span class="sd">        sketch: The shape sketch object.</span>
<span class="sd">        ind: The index.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The TikZ code for the shape sketch with indices.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">begin_scope</span> <span class="o">=</span> <span class="n">get_begin_scope</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>
    <span class="n">body</span> <span class="o">=</span> <span class="n">get_draw</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="n">options</span> <span class="o">=</span> <span class="n">get_line_style_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">fill</span> <span class="ow">and</span> <span class="n">sketch</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">+=</span> <span class="n">get_fill_style_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">smooth</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;smooth cycle&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;smooth&quot;</span><span class="p">]</span>
    <span class="n">options</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>
    <span class="n">body</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">options</span><span class="si">}</span><span class="s2">]&quot;</span>
    <span class="n">vertices</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">vertices</span>
    <span class="n">vertices</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">]</span>
    <span class="n">str_lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;node</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="p">]</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">vertice</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vertices</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">6</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">str_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; -- </span><span class="si">{</span><span class="n">vertice</span><span class="si">}</span><span class="s2"> node</span><span class="se">{{</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="se">}}\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">str_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2">-- </span><span class="si">{</span><span class="n">vertice</span><span class="si">}</span><span class="s2"> node</span><span class="se">{{</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="se">}}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">str_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;-- </span><span class="si">{</span><span class="n">vertice</span><span class="si">}</span><span class="s2"> node</span><span class="se">{{</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="se">}}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>
        <span class="n">str_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot; -- cycle;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">str_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">end_scope</span> <span class="o">=</span> <span class="n">get_end_scope</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">begin_scope</span> <span class="o">+</span> <span class="n">body</span> <span class="o">+</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">str_lines</span><span class="p">)</span> <span class="o">+</span> <span class="n">end_scope</span></div>



<div class="viewcode-block" id="draw_shape_sketch_with_markers">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.draw_shape_sketch_with_markers">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">draw_shape_sketch_with_markers</span><span class="p">(</span><span class="n">sketch</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Draws a shape sketch with markers.</span>

<span class="sd">    Args:</span>
<span class="sd">        sketch: The shape sketch object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The TikZ code for the shape sketch with markers.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># begin_scope = get_begin_scope()</span>
    <span class="n">body</span> <span class="o">=</span> <span class="n">get_draw</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="n">options</span> <span class="o">=</span> <span class="n">get_line_style_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">fill</span> <span class="ow">and</span> <span class="n">sketch</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">+=</span> <span class="n">get_fill_style_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">smooth</span> <span class="ow">and</span> <span class="n">sketch</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;smooth cycle&quot;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">sketch</span><span class="o">.</span><span class="n">smooth</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;smooth&quot;</span><span class="p">]</span>
    <span class="n">options</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">options</span><span class="p">:</span>
        <span class="n">body</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">options</span><span class="si">}</span><span class="s2">]&quot;</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">draw_markers</span><span class="p">:</span>
        <span class="n">marker_options</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">get_marker_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">marker_options</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="n">vertices</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sketch</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>

    <span class="n">str_lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">vertice</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vertices</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">6</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">str_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\t</span><span class="si">{</span><span class="n">vertice</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">str_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">vertice</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">)</span>
    <span class="c1"># if sketch.closed:</span>
    <span class="c1">#     str_lines.append(f&quot; {vertices[0]}&quot;)</span>
    <span class="n">coordinates</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">str_lines</span><span class="p">)</span>
    <span class="n">marker</span> <span class="o">=</span> <span class="n">get_enum_value</span><span class="p">(</span><span class="n">MarkerType</span><span class="p">,</span> <span class="n">sketch</span><span class="o">.</span><span class="n">marker_type</span><span class="p">)</span>
    <span class="c1"># marker = sketch.marker_type.value</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">markers_only</span><span class="p">:</span>
        <span class="n">markers_only</span> <span class="o">=</span> <span class="s2">&quot;only marks ,&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">markers_only</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">draw_markers</span> <span class="ow">and</span> <span class="n">marker_options</span><span class="p">:</span>
        <span class="n">body</span> <span class="o">+=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot; plot[mark = </span><span class="si">{</span><span class="n">marker</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">markers_only</span><span class="si">}</span><span class="s2">mark options = </span><span class="se">{{</span><span class="si">{</span><span class="n">marker_options</span><span class="si">}</span><span class="se">}}</span><span class="s2">] &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">coordinates </span><span class="se">{{</span><span class="si">{</span><span class="n">coordinates</span><span class="si">}</span><span class="se">}}</span><span class="s2">;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">sketch</span><span class="o">.</span><span class="n">draw_markers</span><span class="p">:</span>
        <span class="n">body</span> <span class="o">+=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot; plot[mark = </span><span class="si">{</span><span class="n">marker</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">markers_only</span><span class="si">}</span><span class="s2">] coordinates </span><span class="se">{{</span><span class="si">{</span><span class="n">coordinates</span><span class="si">}</span><span class="se">}}</span><span class="s2">;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">body</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; plot[tension=.5] coordinates </span><span class="se">{{</span><span class="si">{</span><span class="n">coordinates</span><span class="si">}</span><span class="se">}}</span><span class="s2">;</span><span class="se">\n</span><span class="s2">&quot;</span>

    <span class="k">return</span> <span class="n">body</span></div>



<div class="viewcode-block" id="get_begin_scope">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.get_begin_scope">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_begin_scope</span><span class="p">(</span><span class="n">ind</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns \begin{scope}[every node/.append style=nodestyle{ind}].</span>

<span class="sd">    Args:</span>
<span class="sd">        ind: Optional index for the scope.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The begin scope string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ind</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">begin</span><span class="si">{scope}</span><span class="s2">[]</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">begin</span><span class="se">{{</span><span class="s2">scope</span><span class="se">}}</span><span class="s2">[every node/.append style=nodestyle</span><span class="si">{</span><span class="n">ind</span><span class="si">}</span><span class="s2">]</span><span class="se">\n</span><span class="s2">&quot;</span>

    <span class="k">return</span> <span class="n">res</span></div>



<div class="viewcode-block" id="get_end_scope">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.get_end_scope">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_end_scope</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns \\end{scope}.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The end scope string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">end</span><span class="si">{scope}</span><span class="se">\n</span><span class="s2">&quot;</span></div>


<div class="viewcode-block" id="draw_pattern_sketch">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.draw_pattern_sketch">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">draw_pattern_sketch</span><span class="p">(</span><span class="n">sketch</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Draws a pattern sketch.</span>

<span class="sd">    Args:</span>
<span class="sd">        sketch: The pattern sketch object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The TikZ code for the pattern sketch.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">begin_scope</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">begin</span><span class="si">{scope}</span><span class="s2">&quot;</span>

    <span class="n">options</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">back_style</span> <span class="o">==</span> <span class="n">BackStyle</span><span class="o">.</span><span class="n">PATTERN</span> <span class="ow">and</span> <span class="n">sketch</span><span class="o">.</span><span class="n">fill</span> <span class="ow">and</span> <span class="n">sketch</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">+=</span> <span class="n">get_pattern_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">stroke</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">+=</span> <span class="n">get_line_style_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">closed</span> <span class="ow">and</span> <span class="n">sketch</span><span class="o">.</span><span class="n">fill</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">+=</span> <span class="n">get_fill_style_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">smooth</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;smooth&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">back_style</span> <span class="o">==</span> <span class="n">BackStyle</span><span class="o">.</span><span class="n">SHADING</span> <span class="ow">and</span> <span class="n">sketch</span><span class="o">.</span><span class="n">fill</span> <span class="ow">and</span> <span class="n">sketch</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">+=</span> <span class="n">get_shading_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="n">options</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">options</span><span class="p">:</span>
        <span class="n">begin_scope</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">options</span><span class="si">}</span><span class="s2">]</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">end_scope</span> <span class="o">=</span> <span class="n">get_end_scope</span><span class="p">()</span>

    <span class="n">pattern</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">pattern</span>
    <span class="n">draw</span> <span class="o">=</span> <span class="n">get_draw</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="n">all_vertices</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">kernel_vertices</span> <span class="o">@</span> <span class="n">sketch</span><span class="o">.</span><span class="n">all_matrices</span>
    <span class="n">vertices_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hsplit</span><span class="p">(</span><span class="n">all_vertices</span><span class="p">,</span> <span class="n">sketch</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>
    <span class="n">shapes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">vertices</span> <span class="ow">in</span> <span class="n">vertices_list</span><span class="p">:</span>
        <span class="n">vertices</span> <span class="o">@=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">xform_matrix</span>
        <span class="n">vertices</span> <span class="o">=</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">vert</span><span class="p">)</span> <span class="k">for</span> <span class="n">vert</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">[:,:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span>
        <span class="n">str_lines</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">vertice</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vertices</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">8</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">str_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;-- </span><span class="si">{</span><span class="n">vertice</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">str_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2">-- </span><span class="si">{</span><span class="n">vertice</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">str_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;-- </span><span class="si">{</span><span class="n">vertice</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>
            <span class="n">str_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;-- cycle;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">str_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">shapes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">draw</span> <span class="o">+</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">str_lines</span><span class="p">))</span>


    <span class="k">return</span> <span class="n">begin_scope</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">options</span><span class="si">}</span><span class="s2">]</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span>  <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">shapes</span><span class="p">)</span> <span class="o">+</span> <span class="n">end_scope</span></div>



<div class="viewcode-block" id="draw_sketch">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.draw_sketch">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">draw_sketch</span><span class="p">(</span><span class="n">sketch</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Draws a plain shape sketch.</span>

<span class="sd">    Args:</span>
<span class="sd">        sketch: The shape sketch object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The TikZ code for the plain shape sketch.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">get_draw</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">res</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span>
    <span class="n">options</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">back_style</span> <span class="o">==</span> <span class="n">BackStyle</span><span class="o">.</span><span class="n">PATTERN</span> <span class="ow">and</span> <span class="n">sketch</span><span class="o">.</span><span class="n">fill</span> <span class="ow">and</span> <span class="n">sketch</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">+=</span> <span class="n">get_pattern_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">stroke</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">+=</span> <span class="n">get_line_style_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">closed</span> <span class="ow">and</span> <span class="n">sketch</span><span class="o">.</span><span class="n">fill</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">+=</span> <span class="n">get_fill_style_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">smooth</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;smooth&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">back_style</span> <span class="o">==</span> <span class="n">BackStyle</span><span class="o">.</span><span class="n">SHADING</span> <span class="ow">and</span> <span class="n">sketch</span><span class="o">.</span><span class="n">fill</span> <span class="ow">and</span> <span class="n">sketch</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">+=</span> <span class="n">get_shading_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="n">options</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">options</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">options</span><span class="si">}</span><span class="s2">]&quot;</span>
    <span class="n">vertices</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">vertices</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span>
    <span class="n">str_lines</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">vertice</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vertices</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">8</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">str_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;-- </span><span class="si">{</span><span class="n">vertice</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">str_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2">-- </span><span class="si">{</span><span class="n">vertice</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">str_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;-- </span><span class="si">{</span><span class="n">vertice</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>
        <span class="n">str_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;-- cycle;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">str_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">res</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">str_lines</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">str_lines</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span></div>



<div class="viewcode-block" id="draw_shape_sketch">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.draw_shape_sketch">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">draw_shape_sketch</span><span class="p">(</span><span class="n">sketch</span><span class="p">,</span> <span class="n">ind</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Draws a shape sketch.</span>

<span class="sd">    Args:</span>
<span class="sd">        sketch: The shape sketch object.</span>
<span class="sd">        ind: Optional index for the shape sketch.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The TikZ code for the shape sketch.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">d_subtype_draw</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">sg</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">ARC_SKETCH</span><span class="p">:</span> <span class="n">draw_arc_sketch</span><span class="p">,</span>
        <span class="n">sg</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">BEZIER_SKETCH</span><span class="p">:</span> <span class="n">draw_bezier_sketch</span><span class="p">,</span>
        <span class="n">sg</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">CIRCLE_SKETCH</span><span class="p">:</span> <span class="n">draw_circle_sketch</span><span class="p">,</span>
        <span class="n">sg</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">ELLIPSE_SKETCH</span><span class="p">:</span> <span class="n">draw_ellipse_sketch</span><span class="p">,</span>
        <span class="n">sg</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">LINE_SKETCH</span><span class="p">:</span> <span class="n">draw_line_sketch</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">subtype</span> <span class="ow">in</span> <span class="n">d_subtype_draw</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">d_subtype_draw</span><span class="p">[</span><span class="n">sketch</span><span class="o">.</span><span class="n">subtype</span><span class="p">](</span><span class="n">sketch</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">sketch</span><span class="o">.</span><span class="n">draw_markers</span> <span class="ow">and</span> <span class="n">sketch</span><span class="o">.</span><span class="n">marker_type</span> <span class="o">==</span> <span class="n">MarkerType</span><span class="o">.</span><span class="n">INDICES</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">draw_shape_sketch_with_indices</span><span class="p">(</span><span class="n">sketch</span><span class="p">,</span> <span class="n">ind</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">sketch</span><span class="o">.</span><span class="n">draw_markers</span> <span class="ow">or</span> <span class="n">sketch</span><span class="o">.</span><span class="n">smooth</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">draw_shape_sketch_with_markers</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">draw_sketch</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">res</span></div>


<div class="viewcode-block" id="draw_line_sketch">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.draw_line_sketch">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">draw_line_sketch</span><span class="p">(</span><span class="n">sketch</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Draws a line sketch.</span>

<span class="sd">    Args:</span>
<span class="sd">        sketch: The line sketch object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The TikZ code for the line sketch.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">begin_scope</span> <span class="o">=</span> <span class="n">get_begin_scope</span><span class="p">()</span>
    <span class="n">res</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">draw&quot;</span>
    <span class="n">exceptions</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;draw_fillets&quot;</span><span class="p">,</span> <span class="s2">&quot;fillet_radius&quot;</span><span class="p">,</span> <span class="s2">&quot;line_join&quot;</span><span class="p">,</span> <span class="s2">&quot;line_miter_limit&quot;</span><span class="p">]</span>
    <span class="n">options</span> <span class="o">=</span> <span class="n">get_line_style_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">,</span> <span class="n">exceptions</span><span class="o">=</span><span class="n">exceptions</span><span class="p">)</span>

    <span class="n">start</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">end</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">options</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">options</span><span class="si">}</span><span class="s2">]&quot;</span>
    <span class="n">res</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">start</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2"> -- </span><span class="si">{</span><span class="n">end</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">;</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">end_scope</span> <span class="o">=</span> <span class="n">get_end_scope</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">begin_scope</span> <span class="o">+</span> <span class="n">res</span> <span class="o">+</span> <span class="n">end_scope</span></div>



<div class="viewcode-block" id="draw_circle_sketch">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.draw_circle_sketch">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">draw_circle_sketch</span><span class="p">(</span><span class="n">sketch</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Draws a circle sketch.</span>

<span class="sd">    Args:</span>
<span class="sd">        sketch: The circle sketch object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The TikZ code for the circle sketch.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">begin_scope</span> <span class="o">=</span> <span class="n">get_begin_scope</span><span class="p">()</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">get_draw</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="n">options</span> <span class="o">=</span> <span class="n">get_line_style_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="n">fill_options</span> <span class="o">=</span> <span class="n">get_fill_style_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="n">options</span> <span class="o">+=</span> <span class="n">fill_options</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">smooth</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;smooth&quot;</span><span class="p">]</span>
    <span class="n">options</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">options</span><span class="si">}</span><span class="s2">]&quot;</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">center</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">res</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s2">) circle (</span><span class="si">{</span><span class="n">sketch</span><span class="o">.</span><span class="n">radius</span><span class="si">}</span><span class="s2">);</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">end_scope</span> <span class="o">=</span> <span class="n">get_end_scope</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">begin_scope</span> <span class="o">+</span> <span class="n">res</span> <span class="o">+</span> <span class="n">end_scope</span></div>



<div class="viewcode-block" id="draw_rect_sketch">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.draw_rect_sketch">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">draw_rect_sketch</span><span class="p">(</span><span class="n">sketch</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Draws a rectangle sketch.</span>

<span class="sd">    Args:</span>
<span class="sd">        sketch: The rectangle sketch object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The TikZ code for the rectangle sketch.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">begin_scope</span> <span class="o">=</span> <span class="n">get_begin_scope</span><span class="p">()</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">get_draw</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="n">options</span> <span class="o">=</span> <span class="n">get_line_style_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="n">fill_options</span> <span class="o">=</span> <span class="n">get_fill_style_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="n">options</span> <span class="o">+=</span> <span class="n">fill_options</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">smooth</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;smooth&quot;</span><span class="p">]</span>
    <span class="n">options</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">options</span><span class="si">}</span><span class="s2">]&quot;</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">center</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">sketch</span><span class="o">.</span><span class="n">height</span>
    <span class="n">res</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s2">) rectangle (</span><span class="si">{</span><span class="n">width</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">height</span><span class="si">}</span><span class="s2">);</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">end_scope</span> <span class="o">=</span> <span class="n">get_end_scope</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">begin_scope</span> <span class="o">+</span> <span class="n">res</span> <span class="o">+</span> <span class="n">end_scope</span></div>


<div class="viewcode-block" id="draw_ellipse_sketch">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.draw_ellipse_sketch">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">draw_ellipse_sketch</span><span class="p">(</span><span class="n">sketch</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Draws an ellipse sketch.</span>

<span class="sd">    Args:</span>
<span class="sd">        sketch: The ellipse sketch object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The TikZ code for the ellipse sketch.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">begin_scope</span> <span class="o">=</span> <span class="n">get_begin_scope</span><span class="p">()</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">get_draw</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="n">options</span> <span class="o">=</span> <span class="n">get_line_style_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="n">fill_options</span> <span class="o">=</span> <span class="n">get_fill_style_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="n">options</span> <span class="o">+=</span> <span class="n">fill_options</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">smooth</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;smooth&quot;</span><span class="p">]</span>
    <span class="n">angle</span> <span class="o">=</span> <span class="n">degrees</span><span class="p">(</span><span class="n">sketch</span><span class="o">.</span><span class="n">angle</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">center</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">angle</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">+=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;rotate around= </span><span class="se">{{</span><span class="si">{</span><span class="n">angle</span><span class="si">}</span><span class="s2">:(</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s2">)</span><span class="se">}}</span><span class="s2">&quot;</span><span class="p">]</span>
    <span class="n">options</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">options</span><span class="si">}</span><span class="s2">]&quot;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">x_radius</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">y_radius</span>

    <span class="n">res</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s2">) ellipse (</span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2">);</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">end_scope</span> <span class="o">=</span> <span class="n">get_end_scope</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">begin_scope</span> <span class="o">+</span> <span class="n">res</span> <span class="o">+</span> <span class="n">end_scope</span></div>



<div class="viewcode-block" id="draw_arc_sketch">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.draw_arc_sketch">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">draw_arc_sketch</span><span class="p">(</span><span class="n">sketch</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Draws an arc sketch.</span>

<span class="sd">    Args:</span>
<span class="sd">        sketch: The arc sketch object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The TikZ code for the arc sketch.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">get_draw</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">res</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;smooth cycle&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;smooth&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">back_style</span> <span class="o">==</span> <span class="n">BackStyle</span><span class="o">.</span><span class="n">PATTERN</span> <span class="ow">and</span> <span class="n">sketch</span><span class="o">.</span><span class="n">fill</span> <span class="ow">and</span> <span class="n">sketch</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">+=</span> <span class="n">get_pattern_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">stroke</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">+=</span> <span class="n">get_line_style_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">closed</span> <span class="ow">and</span> <span class="n">sketch</span><span class="o">.</span><span class="n">fill</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">+=</span> <span class="n">get_fill_style_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">back_style</span> <span class="o">==</span> <span class="n">BackStyle</span><span class="o">.</span><span class="n">SHADING</span> <span class="ow">and</span> <span class="n">sketch</span><span class="o">.</span><span class="n">fill</span> <span class="ow">and</span> <span class="n">sketch</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">+=</span> <span class="n">get_shading_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="n">options</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">options</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">options</span><span class="si">}</span><span class="s2">] plot[tension=.8] coordinates&quot;</span> <span class="o">+</span> <span class="s2">&quot;{&quot;</span>
    <span class="n">vertices</span> <span class="o">=</span> <span class="p">[</span><span class="n">round_point</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">sketch</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vertices</span><span class="p">)</span>
    <span class="n">str_lines</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">vertice</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vertices</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">8</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">str_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">vertice</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">str_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2"> </span><span class="si">{</span><span class="n">vertice</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">str_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">vertice</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sketch</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>
        <span class="n">str_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot; cycle;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">str_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;};</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">res</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">str_lines</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">str_lines</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span></div>


<div class="viewcode-block" id="draw_bezier_sketch">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.draw_bezier_sketch">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">draw_bezier_sketch</span><span class="p">(</span><span class="n">sketch</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Draws a Bezier curve sketch.</span>

<span class="sd">    Args:</span>
<span class="sd">        sketch: The Bezier curve sketch object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The TikZ code for the Bezier curve sketch.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">begin_scope</span> <span class="o">=</span> <span class="n">get_begin_scope</span><span class="p">()</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">get_draw</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="n">options</span> <span class="o">=</span> <span class="n">get_line_style_options</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
    <span class="n">options</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">options</span><span class="si">}</span><span class="s2">]&quot;</span>
    <span class="n">p1</span><span class="p">,</span> <span class="n">cp1</span><span class="p">,</span> <span class="n">cp2</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">sketch</span><span class="o">.</span><span class="n">control_points</span>
    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">p1</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">cp1</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span> <span class="o">=</span> <span class="n">cp2</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">x4</span><span class="p">,</span> <span class="n">y4</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">res</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; (</span><span class="si">{</span><span class="n">x1</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">y1</span><span class="si">}</span><span class="s2">) .. controls (</span><span class="si">{</span><span class="n">x2</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">y2</span><span class="si">}</span><span class="s2">) and (</span><span class="si">{</span><span class="n">x3</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">y3</span><span class="si">}</span><span class="s2">) .. (</span><span class="si">{</span><span class="n">x4</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">y4</span><span class="si">}</span><span class="s2">);</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">end_scope</span> <span class="o">=</span> <span class="n">get_end_scope</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">begin_scope</span> <span class="o">+</span> <span class="n">res</span> <span class="o">+</span> <span class="n">end_scope</span></div>



<div class="viewcode-block" id="draw_line">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.draw_line">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">draw_line</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Tikz code for a line.</span>

<span class="sd">    Args:</span>
<span class="sd">        line: The line object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The TikZ code for the line.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">start</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">p2</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">end</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">options</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">line_width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">options</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">line_width</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">color2tikz</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">color</span><span class="p">)</span>
        <span class="n">options</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">dash_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">options</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">dash_array</span><span class="p">)</span>
    <span class="c1"># options = [line.width, line.color, line.dash_array, line.cap, line.join]</span>
    <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">line_width</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">path[</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">options</span><span class="p">)</span><span class="si">}</span><span class="s2">] </span><span class="si">{</span><span class="n">p1</span><span class="si">}</span><span class="s2"> -- </span><span class="si">{</span><span class="n">p2</span><span class="si">}</span><span class="s2">;</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">draw[</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">options</span><span class="p">)</span><span class="si">}</span><span class="s2">] </span><span class="si">{</span><span class="n">p1</span><span class="si">}</span><span class="s2"> -- </span><span class="si">{</span><span class="n">p2</span><span class="si">}</span><span class="s2">;</span><span class="se">\n</span><span class="s2">&quot;</span>

    <span class="k">return</span> <span class="n">res</span></div>



<div class="viewcode-block" id="is_stroked">
<a class="viewcode-back" href="../../../simetri.tikz.html#simetri.tikz.tikz.is_stroked">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">is_stroked</span><span class="p">(</span><span class="n">shape</span><span class="p">:</span> <span class="n">Shape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns True if the shape is stroked.</span>

<span class="sd">    Args:</span>
<span class="sd">        shape (Shape): The shape object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if the shape is stroked, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">shape</span><span class="o">.</span><span class="n">stroke</span> <span class="ow">and</span> <span class="n">shape</span><span class="o">.</span><span class="n">line_color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">shape</span><span class="o">.</span><span class="n">line_width</span> <span class="o">&gt;</span> <span class="mi">0</span></div>



<span class="n">d_sketch_draw</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">sg</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">SHAPE</span><span class="p">:</span> <span class="n">draw_shape_sketch</span><span class="p">,</span>
    <span class="n">sg</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">TAG_SKETCH</span><span class="p">:</span> <span class="n">draw_tag_sketch</span><span class="p">,</span>
    <span class="n">sg</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">LACESKETCH</span><span class="p">:</span> <span class="n">draw_lace_sketch</span><span class="p">,</span>
    <span class="n">sg</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">LINE</span><span class="p">:</span> <span class="n">draw_line_sketch</span><span class="p">,</span>
    <span class="n">sg</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">CIRCLE</span><span class="p">:</span> <span class="n">draw_circle_sketch</span><span class="p">,</span>
    <span class="n">sg</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">ELLIPSE</span><span class="p">:</span> <span class="n">draw_shape_sketch</span><span class="p">,</span>
    <span class="n">sg</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">ARC</span><span class="p">:</span> <span class="n">draw_arc_sketch</span><span class="p">,</span>
    <span class="n">sg</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">BATCH</span><span class="p">:</span> <span class="n">draw_batch_sketch</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">simetri.graphics</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">API Reference:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">src</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Fahri Basegmez.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.1.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
    </div>

    

    
  </body>
</html>