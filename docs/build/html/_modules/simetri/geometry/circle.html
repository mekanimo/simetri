<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>simetri.geometry.circle &#8212; simetri.graphics 0.0.5 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../../../_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=27fed22d" />
    <script src="../../../_static/documentation_options.js?v=282f96c0"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for simetri.geometry.circle</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">math</span><span class="w"> </span><span class="kn">import</span> <span class="n">pi</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">acos</span><span class="p">,</span> <span class="n">atan</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cmath</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">.geometry</span><span class="w"> </span><span class="kn">import</span> <span class="n">distance</span><span class="p">,</span> <span class="n">homogenize</span><span class="p">,</span> <span class="n">side_len_to_radius</span><span class="p">,</span> <span class="n">angle_between_lines2</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">..graphics.affine</span><span class="w"> </span><span class="kn">import</span> <span class="n">rotate</span><span class="p">,</span> <span class="n">scale_matrix</span><span class="p">,</span> <span class="n">rotation_matrix</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">..graphics.shapes</span><span class="w"> </span><span class="kn">import</span> <span class="n">Circle</span>

<span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span>
<span class="n">dot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span>
<span class="n">linalg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span>

<div class="viewcode-block" id="Circle_">
<a class="viewcode-back" href="../../../simetri.geometry.html#simetri.geometry.circle.Circle_">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Circle_</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A simple circle class.&quot;&quot;&quot;</span>

    <span class="n">center</span><span class="p">:</span> <span class="nb">tuple</span>
    <span class="n">radius</span><span class="p">:</span> <span class="nb">float</span></div>


<div class="viewcode-block" id="circle_tangent_to_3_circles">
<a class="viewcode-back" href="../../../simetri.geometry.html#simetri.geometry.circle.circle_tangent_to_3_circles">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">circle_tangent_to_3_circles</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">c3</span><span class="p">,</span> <span class="n">r3</span><span class="p">,</span> <span class="n">s1</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">s2</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">s3</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Given the centers and radii of 3 circles, return the center and radius</span>
<span class="sd">    of a circle that is tangent to all 3 circles.</span>

<span class="sd">    Args:</span>
<span class="sd">        c1 (tuple): Center of the first circle.</span>
<span class="sd">        r1 (float): Radius of the first circle.</span>
<span class="sd">        c2 (tuple): Center of the second circle.</span>
<span class="sd">        r2 (float): Radius of the second circle.</span>
<span class="sd">        c3 (tuple): Center of the third circle.</span>
<span class="sd">        r3 (float): Radius of the third circle.</span>
<span class="sd">        s1 (int, optional): Sign for the first circle. Defaults to -1.</span>
<span class="sd">        s2 (int, optional): Sign for the second circle. Defaults to -1.</span>
<span class="sd">        s3 (int, optional): Sign for the third circle. Defaults to -1.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: Center (x, y) and radius of the tangent circle.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">c1</span>
    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">c2</span>
    <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span> <span class="o">=</span> <span class="n">c3</span>

    <span class="n">v11</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x2</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x1</span>
    <span class="n">v12</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">y2</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">y1</span>
    <span class="n">v13</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">*</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x2</span> <span class="o">*</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">y1</span> <span class="o">*</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">y2</span> <span class="o">*</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">r1</span> <span class="o">*</span> <span class="n">r1</span> <span class="o">+</span> <span class="n">r2</span> <span class="o">*</span> <span class="n">r2</span>
    <span class="n">v14</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">s2</span> <span class="o">*</span> <span class="n">r2</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">s1</span> <span class="o">*</span> <span class="n">r1</span>

    <span class="n">v21</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x3</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x2</span>
    <span class="n">v22</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">y3</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">y2</span>
    <span class="n">v23</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">*</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x3</span> <span class="o">*</span> <span class="n">x3</span> <span class="o">+</span> <span class="n">y2</span> <span class="o">*</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y3</span> <span class="o">*</span> <span class="n">y3</span> <span class="o">-</span> <span class="n">r2</span> <span class="o">*</span> <span class="n">r2</span> <span class="o">+</span> <span class="n">r3</span> <span class="o">*</span> <span class="n">r3</span>
    <span class="n">v24</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">s3</span> <span class="o">*</span> <span class="n">r3</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">s3</span> <span class="o">*</span> <span class="n">r2</span>

    <span class="n">w12</span> <span class="o">=</span> <span class="n">v12</span> <span class="o">/</span> <span class="n">v11</span>
    <span class="n">w13</span> <span class="o">=</span> <span class="n">v13</span> <span class="o">/</span> <span class="n">v11</span>
    <span class="n">w14</span> <span class="o">=</span> <span class="n">v14</span> <span class="o">/</span> <span class="n">v11</span>

    <span class="n">w22</span> <span class="o">=</span> <span class="n">v22</span> <span class="o">/</span> <span class="n">v21</span> <span class="o">-</span> <span class="n">w12</span>
    <span class="n">w23</span> <span class="o">=</span> <span class="n">v23</span> <span class="o">/</span> <span class="n">v21</span> <span class="o">-</span> <span class="n">w13</span>
    <span class="n">w24</span> <span class="o">=</span> <span class="n">v24</span> <span class="o">/</span> <span class="n">v21</span> <span class="o">-</span> <span class="n">w14</span>

    <span class="n">P</span> <span class="o">=</span> <span class="o">-</span><span class="n">w23</span> <span class="o">/</span> <span class="n">w22</span>
    <span class="n">Q</span> <span class="o">=</span> <span class="n">w24</span> <span class="o">/</span> <span class="n">w22</span>
    <span class="n">M</span> <span class="o">=</span> <span class="o">-</span><span class="n">w12</span> <span class="o">*</span> <span class="n">P</span> <span class="o">-</span> <span class="n">w13</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">w14</span> <span class="o">-</span> <span class="n">w12</span> <span class="o">*</span> <span class="n">Q</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">N</span><span class="o">*</span><span class="n">N</span> <span class="o">+</span> <span class="n">Q</span><span class="o">*</span><span class="n">Q</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">b</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">M</span> <span class="o">*</span> <span class="n">N</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">N</span> <span class="o">*</span> <span class="n">x1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">P</span> <span class="o">*</span> <span class="n">Q</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">Q</span> <span class="o">*</span> <span class="n">y1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">s1</span> <span class="o">*</span> <span class="n">r1</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">*</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">M</span> <span class="o">*</span> <span class="n">M</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">M</span> <span class="o">*</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">P</span> <span class="o">*</span> <span class="n">P</span> <span class="o">+</span> <span class="n">y1</span> <span class="o">*</span> <span class="n">y1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">P</span> <span class="o">*</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">r1</span> <span class="o">*</span> <span class="n">r1</span>

    <span class="c1"># Find a root of a quadratic equation.</span>
    <span class="c1"># This requires the circle centers not to be collinear</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">b</span> <span class="o">*</span> <span class="n">b</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">c</span>
    <span class="n">rs</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">b</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">D</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">a</span><span class="p">)</span>

    <span class="n">xs</span> <span class="o">=</span> <span class="n">M</span> <span class="o">+</span> <span class="n">N</span> <span class="o">*</span> <span class="n">rs</span>
    <span class="n">ys</span> <span class="o">=</span> <span class="n">P</span> <span class="o">+</span> <span class="n">Q</span> <span class="o">*</span> <span class="n">rs</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">rs</span><span class="p">)</span></div>


<div class="viewcode-block" id="apollonius">
<a class="viewcode-back" href="../../../simetri.geometry.html#simetri.geometry.circle.apollonius">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">apollonius</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">r3</span><span class="p">,</span> <span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">,</span> <span class="n">z3</span><span class="p">,</span> <span class="n">plus_minus</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Solves the Problem of Apollonius using Descartes&#39; Theorem.</span>

<span class="sd">    Args:</span>
<span class="sd">        r1 (float): Radius of the first circle.</span>
<span class="sd">        r2 (float): Radius of the second circle.</span>
<span class="sd">        r3 (float): Radius of the third circle.</span>
<span class="sd">        z1 (complex): Center of the first circle.</span>
<span class="sd">        z2 (complex): Center of the second circle.</span>
<span class="sd">        z3 (complex): Center of the third circle.</span>
<span class="sd">        plus_minus (int, optional): +1 for outer tangent circle, -1 for inner tangent circle. Defaults to 1.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: Radius and center coordinates (x, y) of the tangent circle, or None if no solution is found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">,</span> <span class="n">k3</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">r1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">r2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">r3</span>

    <span class="c1"># Applying Descartes&#39; Theorem</span>
    <span class="n">k4_values</span> <span class="o">=</span> <span class="p">(</span><span class="n">k1</span> <span class="o">+</span> <span class="n">k2</span> <span class="o">+</span> <span class="n">k3</span><span class="p">)</span> <span class="o">+</span> <span class="n">plus_minus</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">k1</span><span class="o">*</span><span class="n">k2</span> <span class="o">+</span> <span class="n">k2</span><span class="o">*</span><span class="n">k3</span> <span class="o">+</span> <span class="n">k3</span><span class="o">*</span><span class="n">k1</span><span class="p">)</span>

    <span class="c1"># Handle cases where no solution exists (e.g., division by zero)</span>
    <span class="k">if</span> <span class="n">k4_values</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="n">r4</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">k4_values</span>
    <span class="n">z4</span> <span class="o">=</span> <span class="p">((</span><span class="n">k1</span><span class="o">*</span><span class="n">z1</span> <span class="o">+</span> <span class="n">k2</span><span class="o">*</span><span class="n">z2</span> <span class="o">+</span> <span class="n">k3</span><span class="o">*</span><span class="n">z3</span> <span class="o">+</span> <span class="n">plus_minus</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span>
           <span class="n">cmath</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">k1</span><span class="o">*</span><span class="n">k2</span><span class="o">*</span><span class="n">z1</span><span class="o">*</span><span class="n">z2</span> <span class="o">+</span> <span class="n">k2</span><span class="o">*</span><span class="n">k3</span><span class="o">*</span><span class="n">z2</span><span class="o">*</span><span class="n">z3</span> <span class="o">+</span> <span class="n">k3</span><span class="o">*</span><span class="n">k1</span><span class="o">*</span><span class="n">z3</span><span class="o">*</span><span class="n">z1</span><span class="p">))</span> <span class="o">/</span> <span class="n">k4_values</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">r4</span><span class="p">,</span> <span class="n">z4</span></div>




<div class="viewcode-block" id="circle_tangent_to_2_circles">
<a class="viewcode-back" href="../../../simetri.geometry.html#simetri.geometry.circle.circle_tangent_to_2_circles">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">circle_tangent_to_2_circles</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Given the centers and radii of 2 circles, return the center</span>
<span class="sd">    of a circle with radius r that is tangent to both circles.</span>

<span class="sd">    Args:</span>
<span class="sd">        c1 (tuple): Center of the first circle.</span>
<span class="sd">        r1 (float): Radius of the first circle.</span>
<span class="sd">        c2 (tuple): Center of the second circle.</span>
<span class="sd">        r2 (float): Radius of the second circle.</span>
<span class="sd">        r (float): Radius of the tangent circle.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: Centers (x1, y1) and (x2, y2) of the tangent circle.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">c1</span>
    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">c2</span>

    <span class="n">r12</span> <span class="o">=</span> <span class="n">r1</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">r12y1</span> <span class="o">=</span> <span class="n">r12</span> <span class="o">*</span> <span class="n">y1</span>
    <span class="n">r12y2</span> <span class="o">=</span> <span class="n">r12</span> <span class="o">*</span> <span class="n">y2</span>
    <span class="n">r1r2</span> <span class="o">=</span> <span class="n">r1</span> <span class="o">*</span> <span class="n">r2</span>
    <span class="n">r22</span> <span class="o">=</span> <span class="n">r2</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">r22y2</span> <span class="o">=</span> <span class="n">r22</span> <span class="o">*</span> <span class="n">y2</span>
    <span class="n">r_2</span> <span class="o">=</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">rr1</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">r1</span>
    <span class="n">rr1y1</span> <span class="o">=</span> <span class="n">rr1</span> <span class="o">*</span> <span class="n">y1</span>
    <span class="n">rr1y2</span> <span class="o">=</span> <span class="n">rr1</span> <span class="o">*</span> <span class="n">y2</span>
    <span class="n">rr2</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">r2</span>
    <span class="n">rr2y1</span> <span class="o">=</span> <span class="n">rr2</span> <span class="o">*</span> <span class="n">y1</span>
    <span class="n">rr2y2</span> <span class="o">=</span> <span class="n">rr2</span> <span class="o">*</span> <span class="n">y2</span>
    <span class="n">x12</span> <span class="o">=</span> <span class="n">x1</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">x12y1</span> <span class="o">=</span> <span class="n">x12</span> <span class="o">*</span> <span class="n">y1</span>
    <span class="n">x12y2</span> <span class="o">=</span> <span class="n">x12</span> <span class="o">*</span> <span class="n">y2</span>
    <span class="n">x1_x2</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x2</span>
    <span class="n">x1x2</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">*</span> <span class="n">x2</span>
    <span class="n">x1x2y1</span> <span class="o">=</span> <span class="n">x1x2</span> <span class="o">*</span> <span class="n">y1</span>
    <span class="n">x1x2y2</span> <span class="o">=</span> <span class="n">x1x2</span> <span class="o">*</span> <span class="n">y2</span>
    <span class="n">x22</span> <span class="o">=</span> <span class="n">x2</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">x22y1</span> <span class="o">=</span> <span class="n">x22</span> <span class="o">*</span> <span class="n">y1</span>
    <span class="n">x22y2</span> <span class="o">=</span> <span class="n">x22</span> <span class="o">*</span> <span class="n">y2</span>
    <span class="n">y12</span> <span class="o">=</span> <span class="n">y1</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">y12y2</span> <span class="o">=</span> <span class="n">y12</span> <span class="o">*</span> <span class="n">y2</span>
    <span class="n">y13</span> <span class="o">=</span> <span class="n">y1</span><span class="o">**</span><span class="mi">3</span>
    <span class="n">y1y2</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">*</span> <span class="n">y2</span>
    <span class="n">y22</span> <span class="o">=</span> <span class="n">y2</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">y1y22</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">*</span> <span class="n">y22</span>
    <span class="n">y23</span> <span class="o">=</span> <span class="n">y2</span><span class="o">**</span><span class="mi">3</span>

    <span class="n">x_1</span> <span class="o">=</span> <span class="p">(</span>
        <span class="o">-</span><span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y2</span><span class="p">)</span>
        <span class="o">*</span> <span class="p">(</span>
            <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">rr1y1</span>
            <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">rr1y2</span>
            <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">rr2y1</span>
            <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">rr2y2</span>
            <span class="o">-</span> <span class="n">r12y1</span>
            <span class="o">+</span> <span class="n">r12y2</span>
            <span class="o">+</span> <span class="n">r22</span> <span class="o">*</span> <span class="n">y1</span>
            <span class="o">-</span> <span class="n">r22y2</span>
            <span class="o">+</span> <span class="n">x12y1</span>
            <span class="o">+</span> <span class="n">x12y2</span>
            <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x1x2y1</span>
            <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x1x2y2</span>
            <span class="o">+</span> <span class="n">x22y1</span>
            <span class="o">+</span> <span class="n">x22y2</span>
            <span class="o">+</span> <span class="n">y13</span>
            <span class="o">-</span> <span class="n">y12y2</span>
            <span class="o">-</span> <span class="n">y1y22</span>
            <span class="o">+</span> <span class="n">y23</span>
            <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span>
                <span class="p">(</span><span class="o">-</span><span class="n">r12</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">r1r2</span> <span class="o">-</span> <span class="n">r22</span> <span class="o">+</span> <span class="n">x12</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x1x2</span> <span class="o">+</span> <span class="n">x22</span> <span class="o">+</span> <span class="n">y12</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">y1y2</span> <span class="o">+</span> <span class="n">y22</span><span class="p">)</span>
                <span class="o">*</span> <span class="p">(</span>
                    <span class="mi">4</span> <span class="o">*</span> <span class="n">r_2</span>
                    <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">rr1</span>
                    <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">rr2</span>
                    <span class="o">+</span> <span class="n">r12</span>
                    <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">r1r2</span>
                    <span class="o">+</span> <span class="n">r22</span>
                    <span class="o">-</span> <span class="n">x12</span>
                    <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x1x2</span>
                    <span class="o">-</span> <span class="n">x22</span>
                    <span class="o">-</span> <span class="n">y12</span>
                    <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">y1y2</span>
                    <span class="o">-</span> <span class="n">y22</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">x1</span> <span class="o">+</span> <span class="n">x2</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="o">-</span> <span class="p">(</span><span class="n">x12</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x1x2</span> <span class="o">+</span> <span class="n">x22</span> <span class="o">+</span> <span class="n">y12</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">y1y2</span> <span class="o">+</span> <span class="n">y22</span><span class="p">)</span>
        <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">rr1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">rr2</span> <span class="o">+</span> <span class="n">r12</span> <span class="o">-</span> <span class="n">r22</span> <span class="o">-</span> <span class="n">x12</span> <span class="o">+</span> <span class="n">x22</span> <span class="o">-</span> <span class="n">y12</span> <span class="o">+</span> <span class="n">y22</span><span class="p">)</span>
    <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1_x2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x12</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x1x2</span> <span class="o">+</span> <span class="n">x22</span> <span class="o">+</span> <span class="n">y12</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">y1y2</span> <span class="o">+</span> <span class="n">y22</span><span class="p">))</span>

    <span class="n">y_1</span> <span class="o">=</span> <span class="p">(</span>
        <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">rr1y1</span>
        <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">rr1y2</span>
        <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">rr2y1</span>
        <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">rr2y2</span>
        <span class="o">-</span> <span class="n">r12y1</span>
        <span class="o">+</span> <span class="n">r12y2</span>
        <span class="o">+</span> <span class="n">r22</span> <span class="o">*</span> <span class="n">y1</span>
        <span class="o">-</span> <span class="n">r22y2</span>
        <span class="o">+</span> <span class="n">x12y1</span>
        <span class="o">+</span> <span class="n">x12y2</span>
        <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x1x2y1</span>
        <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x1x2y2</span>
        <span class="o">+</span> <span class="n">x22y1</span>
        <span class="o">+</span> <span class="n">x22y2</span>
        <span class="o">+</span> <span class="n">y13</span>
        <span class="o">-</span> <span class="n">y12y2</span>
        <span class="o">-</span> <span class="n">y1y22</span>
        <span class="o">+</span> <span class="n">y23</span>
        <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span>
            <span class="p">(</span><span class="o">-</span><span class="n">r12</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">r1r2</span> <span class="o">-</span> <span class="n">r22</span> <span class="o">+</span> <span class="n">x12</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x1x2</span> <span class="o">+</span> <span class="n">x22</span> <span class="o">+</span> <span class="n">y12</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">y1y2</span> <span class="o">+</span> <span class="n">y22</span><span class="p">)</span>
            <span class="o">*</span> <span class="p">(</span>
                <span class="mi">4</span> <span class="o">*</span> <span class="n">r_2</span>
                <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">rr1</span>
                <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">rr2</span>
                <span class="o">+</span> <span class="n">r12</span>
                <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">r1r2</span>
                <span class="o">+</span> <span class="n">r22</span>
                <span class="o">-</span> <span class="n">x12</span>
                <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x1x2</span>
                <span class="o">-</span> <span class="n">x22</span>
                <span class="o">-</span> <span class="n">y12</span>
                <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">y1y2</span>
                <span class="o">-</span> <span class="n">y22</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">x1</span> <span class="o">+</span> <span class="n">x2</span><span class="p">)</span>
    <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">x12</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x1x2</span> <span class="o">+</span> <span class="n">x22</span> <span class="o">+</span> <span class="n">y12</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">y1y2</span> <span class="o">+</span> <span class="n">y22</span><span class="p">))</span>

    <span class="n">x_2</span> <span class="o">=</span> <span class="p">(</span>
        <span class="o">-</span><span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y2</span><span class="p">)</span>
        <span class="o">*</span> <span class="p">(</span>
            <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">rr1y1</span>
            <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">rr1y2</span>
            <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">rr2y1</span>
            <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">rr2y2</span>
            <span class="o">-</span> <span class="n">r12y1</span>
            <span class="o">+</span> <span class="n">r12y2</span>
            <span class="o">+</span> <span class="n">r22</span> <span class="o">*</span> <span class="n">y1</span>
            <span class="o">-</span> <span class="n">r22y2</span>
            <span class="o">+</span> <span class="n">x12y1</span>
            <span class="o">+</span> <span class="n">x12y2</span>
            <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x1x2y1</span>
            <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x1x2y2</span>
            <span class="o">+</span> <span class="n">x22y1</span>
            <span class="o">+</span> <span class="n">x22y2</span>
            <span class="o">+</span> <span class="n">y13</span>
            <span class="o">-</span> <span class="n">y12y2</span>
            <span class="o">-</span> <span class="n">y1y22</span>
            <span class="o">+</span> <span class="n">y23</span>
            <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span>
                <span class="p">(</span><span class="o">-</span><span class="n">r12</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">r1r2</span> <span class="o">-</span> <span class="n">r22</span> <span class="o">+</span> <span class="n">x12</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x1x2</span> <span class="o">+</span> <span class="n">x22</span> <span class="o">+</span> <span class="n">y12</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">y1y2</span> <span class="o">+</span> <span class="n">y22</span><span class="p">)</span>
                <span class="o">*</span> <span class="p">(</span>
                    <span class="mi">4</span> <span class="o">*</span> <span class="n">r_2</span>
                    <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">rr1</span>
                    <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">rr2</span>
                    <span class="o">+</span> <span class="n">r12</span>
                    <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">r1r2</span>
                    <span class="o">+</span> <span class="n">r22</span>
                    <span class="o">-</span> <span class="n">x12</span>
                    <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x1x2</span>
                    <span class="o">-</span> <span class="n">x22</span>
                    <span class="o">-</span> <span class="n">y12</span>
                    <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">y1y2</span>
                    <span class="o">-</span> <span class="n">y22</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="p">(</span><span class="n">x1_x2</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="o">-</span> <span class="p">(</span><span class="n">x12</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x1x2</span> <span class="o">+</span> <span class="n">x22</span> <span class="o">+</span> <span class="n">y12</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">y1y2</span> <span class="o">+</span> <span class="n">y22</span><span class="p">)</span>
        <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">rr1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">rr2</span> <span class="o">+</span> <span class="n">r12</span> <span class="o">-</span> <span class="n">r22</span> <span class="o">-</span> <span class="n">x12</span> <span class="o">+</span> <span class="n">x22</span> <span class="o">-</span> <span class="n">y12</span> <span class="o">+</span> <span class="n">y22</span><span class="p">)</span>
    <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1_x2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x12</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x1x2</span> <span class="o">+</span> <span class="n">x22</span> <span class="o">+</span> <span class="n">y12</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">y1y2</span> <span class="o">+</span> <span class="n">y22</span><span class="p">))</span>

    <span class="n">y_2</span> <span class="o">=</span> <span class="p">(</span>
        <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">rr1y1</span>
        <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">rr1y2</span>
        <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">rr2y1</span>
        <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">rr2y2</span>
        <span class="o">-</span> <span class="n">r12y1</span>
        <span class="o">+</span> <span class="n">r12y2</span>
        <span class="o">+</span> <span class="n">r22</span> <span class="o">*</span> <span class="n">y1</span>
        <span class="o">-</span> <span class="n">r22y2</span>
        <span class="o">+</span> <span class="n">x12y1</span>
        <span class="o">+</span> <span class="n">x12y2</span>
        <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x1x2y1</span>
        <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x1x2y2</span>
        <span class="o">+</span> <span class="n">x22y1</span>
        <span class="o">+</span> <span class="n">x22y2</span>
        <span class="o">+</span> <span class="n">y13</span>
        <span class="o">-</span> <span class="n">y12y2</span>
        <span class="o">-</span> <span class="n">y1y22</span>
        <span class="o">+</span> <span class="n">y23</span>
        <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span>
            <span class="p">(</span><span class="o">-</span><span class="n">r12</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">r1r2</span> <span class="o">-</span> <span class="n">r22</span> <span class="o">+</span> <span class="n">x12</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x1x2</span> <span class="o">+</span> <span class="n">x22</span> <span class="o">+</span> <span class="n">y12</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">y1y2</span> <span class="o">+</span> <span class="n">y22</span><span class="p">)</span>
            <span class="o">*</span> <span class="p">(</span>
                <span class="mi">4</span> <span class="o">*</span> <span class="n">r_2</span>
                <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">rr1</span>
                <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">rr2</span>
                <span class="o">+</span> <span class="n">r12</span>
                <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">r1r2</span>
                <span class="o">+</span> <span class="n">r22</span>
                <span class="o">-</span> <span class="n">x12</span>
                <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x1x2</span>
                <span class="o">-</span> <span class="n">x22</span>
                <span class="o">-</span> <span class="n">y12</span>
                <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">y1y2</span>
                <span class="o">-</span> <span class="n">y22</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="o">*</span> <span class="p">(</span><span class="n">x1_x2</span><span class="p">)</span>
    <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">x12</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x1x2</span> <span class="o">+</span> <span class="n">x22</span> <span class="o">+</span> <span class="n">y12</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">y1y2</span> <span class="o">+</span> <span class="n">y22</span><span class="p">))</span>

    <span class="k">return</span> <span class="p">((</span><span class="n">x_1</span><span class="p">,</span> <span class="n">y_1</span><span class="p">),</span> <span class="p">(</span><span class="n">x_2</span><span class="p">,</span> <span class="n">y_2</span><span class="p">))</span></div>



<div class="viewcode-block" id="tangent_points">
<a class="viewcode-back" href="../../../simetri.geometry.html#simetri.geometry.circle.tangent_points">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">tangent_points</span><span class="p">(</span><span class="n">center1</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">center2</span><span class="p">,</span> <span class="n">radius2</span><span class="p">,</span> <span class="n">cross</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the tangent points (p1, p2, p3, p4) in world coordinates.</span>

<span class="sd">    Args:</span>
<span class="sd">        center1 (tuple): Center of the first circle.</span>
<span class="sd">        radius (float): Radius of the first circle.</span>
<span class="sd">        center2 (tuple): Center of the second circle.</span>
<span class="sd">        radius2 (float): Radius of the second circle.</span>
<span class="sd">        cross (bool, optional): Whether to calculate crossing tangents. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: Tangent points (p1, p2, p3, p4) in world coordinates.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">c1</span> <span class="o">=</span> <span class="n">Circle_</span><span class="p">(</span><span class="n">center1</span><span class="p">,</span> <span class="n">radius</span><span class="p">)</span>
    <span class="n">c2</span> <span class="o">=</span> <span class="n">Circle_</span><span class="p">(</span><span class="n">center2</span><span class="p">,</span> <span class="n">radius2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">radius</span> <span class="o">&lt;</span> <span class="n">radius2</span><span class="p">:</span>
        <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c1</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">c1</span><span class="o">.</span><span class="n">center</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="n">distance</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">c2</span><span class="o">.</span><span class="n">center</span><span class="p">)</span>
    <span class="n">r1</span> <span class="o">=</span> <span class="n">c1</span><span class="o">.</span><span class="n">radius</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">c2</span><span class="o">.</span><span class="n">radius</span>

    <span class="k">if</span> <span class="n">cross</span><span class="p">:</span>
        <span class="n">dr</span> <span class="o">=</span> <span class="n">r1</span> <span class="o">+</span> <span class="n">r2</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dr</span> <span class="o">=</span> <span class="n">r1</span> <span class="o">-</span> <span class="n">r2</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">dist</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">dr</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">r1</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="p">]</span>
    <span class="n">p2</span> <span class="o">=</span> <span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span>
    <span class="n">points</span> <span class="o">=</span> <span class="n">homogenize</span><span class="p">([</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">])</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">angle_between_lines2</span><span class="p">((</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dr</span><span class="p">),</span> <span class="n">pos</span><span class="p">,</span> <span class="n">c2</span><span class="o">.</span><span class="n">center</span><span class="p">)</span>
    <span class="n">tp1w</span><span class="p">,</span> <span class="n">tp2w</span> <span class="o">=</span> <span class="n">rotate</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">atan</span><span class="p">(</span><span class="n">dr</span> <span class="o">/</span> <span class="n">x</span><span class="p">)</span>
    <span class="n">tp3w</span> <span class="o">=</span> <span class="n">rotate</span><span class="p">([</span><span class="n">tp1w</span><span class="p">],</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">beta</span><span class="p">,</span> <span class="n">pos</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">tp4w</span> <span class="o">=</span> <span class="n">rotate</span><span class="p">([</span><span class="n">tp2w</span><span class="p">],</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">beta</span><span class="p">,</span> <span class="n">c2</span><span class="o">.</span><span class="n">center</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">tp1w</span><span class="p">,</span> <span class="n">tp2w</span><span class="p">,</span> <span class="n">tp3w</span><span class="p">,</span> <span class="n">tp4w</span><span class="p">)</span></div>



<div class="viewcode-block" id="circle_area">
<a class="viewcode-back" href="../../../simetri.geometry.html#simetri.geometry.circle.circle_area">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">circle_area</span><span class="p">(</span><span class="n">rad</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Given the radius of a circle, return the area of the circle.</span>

<span class="sd">    Args:</span>
<span class="sd">        rad (float): Radius of the circle.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: Area of the circle.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">rad</span><span class="o">**</span><span class="mi">2</span></div>



<div class="viewcode-block" id="circle_circumference">
<a class="viewcode-back" href="../../../simetri.geometry.html#simetri.geometry.circle.circle_circumference">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">circle_circumference</span><span class="p">(</span><span class="n">rad</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Given the radius of a circle, return the circumference of the circle.</span>

<span class="sd">    Args:</span>
<span class="sd">        rad (float): Radius of the circle.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: Circumference of the circle.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">rad</span></div>



<div class="viewcode-block" id="flower_angle">
<a class="viewcode-back" href="../../../simetri.geometry.html#simetri.geometry.circle.flower_angle">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">flower_angle</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">r3</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Given the radii of 3 circles forming an interstice, return the angle between</span>
<span class="sd">    the lines connecting circles&#39; centers to center of the circle with r1 radius.</span>

<span class="sd">    Args:</span>
<span class="sd">        r1 (float): Radius of the first circle.</span>
<span class="sd">        r2 (float): Radius of the second circle.</span>
<span class="sd">        r3 (float): Radius of the third circle.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: Angle between the lines connecting circles&#39; centers.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">angle</span> <span class="o">=</span> <span class="n">acos</span><span class="p">(</span>
        <span class="p">((</span><span class="n">r1</span> <span class="o">+</span> <span class="n">r2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">r1</span> <span class="o">+</span> <span class="n">r3</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">r2</span> <span class="o">+</span> <span class="n">r3</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">r1</span> <span class="o">+</span> <span class="n">r2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">r1</span> <span class="o">+</span> <span class="n">r3</span><span class="p">))</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">angle</span></div>




<span class="n">ratios</span> <span class="o">=</span> <span class="p">{</span><span class="mi">8</span><span class="p">:</span> <span class="mf">0.4974</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mf">0.5394</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="mf">0.575</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="mf">0.6056</span><span class="p">,</span>
        <span class="mi">12</span><span class="p">:</span> <span class="mf">0.6321</span><span class="p">,</span> <span class="mi">13</span><span class="p">:</span> <span class="mf">0.6553</span><span class="p">,</span> <span class="mi">14</span><span class="p">:</span> <span class="mf">0.6757</span><span class="p">,</span> <span class="mi">15</span><span class="p">:</span> <span class="mf">0.6939</span><span class="p">,</span> <span class="mi">16</span><span class="p">:</span> <span class="mf">0.7101</span><span class="p">,</span>
        <span class="mi">17</span><span class="p">:</span> <span class="mf">0.7248</span><span class="p">,</span> <span class="mi">18</span><span class="p">:</span> <span class="mf">0.738</span><span class="p">,</span> <span class="mi">19</span><span class="p">:</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mi">20</span><span class="p">:</span> <span class="mf">0.7609</span><span class="p">}</span>

<div class="viewcode-block" id="circle_flower">
<a class="viewcode-back" href="../../../simetri.geometry.html#simetri.geometry.circle.circle_flower">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">circle_flower</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">layers</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">ratio</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Steiner chain. Return a list of circles that form a flower-like pattern.</span>

<span class="sd">    Args:</span>
<span class="sd">        n (int): Number of circles.</span>
<span class="sd">        radius (float, optional): Radius of the circles. Defaults to 25.</span>
<span class="sd">        layers (int, optional): Number of layers. Defaults to 6.</span>
<span class="sd">        ratio (float, optional): Ratio for scaling. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: List of circles forming a flower-like pattern.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If n is less than 8.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">n</span><span class="o">&lt;</span><span class="mi">8</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;n must be greater than 7&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ratio</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">n</span><span class="o">&lt;</span><span class="mi">21</span><span class="p">:</span>
            <span class="n">ratio</span> <span class="o">=</span> <span class="n">ratios</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ratio</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.000000089767</span> <span class="o">*</span> <span class="n">n</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mf">0.000015821834</span> <span class="o">*</span> <span class="n">n</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
                    <span class="o">-</span><span class="mf">0.001100867708</span> <span class="o">*</span> <span class="n">n</span> <span class="o">**</span><span class="mi">2</span><span class="o">+</span> <span class="mf">0.038096046379</span> <span class="o">*</span> <span class="n">n</span> <span class="o">+</span> <span class="mf">0.327363569038</span><span class="p">)</span>

    <span class="n">r1</span> <span class="o">=</span> <span class="n">side_len_to_radius</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">radius</span><span class="p">)</span>
    <span class="n">circles</span> <span class="o">=</span> <span class="n">Circle</span><span class="p">((</span><span class="n">r1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">radius</span><span class="p">)</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">reps</span><span class="o">=</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">xform</span> <span class="o">=</span> <span class="n">scale_matrix</span><span class="p">(</span><span class="n">ratio</span><span class="p">)</span> <span class="o">@</span> <span class="n">rotation_matrix</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">circles</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">xform_matrix</span><span class="o">=</span><span class="n">xform</span><span class="p">,</span> <span class="n">reps</span><span class="o">=</span><span class="n">layers</span><span class="p">)</span></div>

</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">simetri.graphics</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">API Reference:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">src</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Fahri Basegmez.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.1.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
    </div>

    

    
  </body>
</html>