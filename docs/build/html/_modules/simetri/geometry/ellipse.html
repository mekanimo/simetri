<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>simetri.geometry.ellipse &#8212; simetri.graphics 0.0.5 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../../../_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=27fed22d" />
    <script src="../../../_static/documentation_options.js?v=282f96c0"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for simetri.geometry.ellipse</h1><div class="highlight"><pre>
<span></span><span class="sd">&#39;&#39;&#39;Functions for working with ellipses.&#39;&#39;&#39;</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">copy</span><span class="w"> </span><span class="kn">import</span> <span class="n">deepcopy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">math</span><span class="w"> </span><span class="kn">import</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">atan2</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">degrees</span><span class="p">,</span> <span class="n">ceil</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">..graphics.shape</span><span class="w"> </span><span class="kn">import</span> <span class="n">Shape</span><span class="p">,</span> <span class="n">custom_attributes</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">..graphics.batch</span><span class="w"> </span><span class="kn">import</span> <span class="n">Batch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">..graphics.points</span><span class="w"> </span><span class="kn">import</span> <span class="n">Points</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">..graphics.affine</span><span class="w"> </span><span class="kn">import</span> <span class="n">rotation_matrix</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">..graphics.common</span><span class="w"> </span><span class="kn">import</span> <span class="n">Point</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">..graphics.all_enums</span><span class="w"> </span><span class="kn">import</span> <span class="n">Types</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">..geometry.geometry</span><span class="w"> </span><span class="kn">import</span> <span class="n">line_angle</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">positive_angle</span><span class="p">,</span> <span class="n">homogenize</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">..canvas.style_map</span><span class="w"> </span><span class="kn">import</span> <span class="n">shape_style_map</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">..settings.settings</span><span class="w"> </span><span class="kn">import</span> <span class="n">defaults</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">..helpers.utilities</span><span class="w">  </span><span class="kn">import</span> <span class="n">decompose_transformations</span>


<div class="viewcode-block" id="Arc">
<a class="viewcode-back" href="../../../simetri.geometry.html#simetri.geometry.ellipse.Arc">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Arc</span><span class="p">(</span><span class="n">Shape</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A circular or elliptic arc defined by a center, radius_x, radius_y, start angle,</span>
<span class="sd">    and span angle. If radius_y is not provided, the arc is a circular arc.&quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">center</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span>
        <span class="n">radius_x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">radius_y</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">start_angle</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">span_angle</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">rot_angle</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">n_points</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">xform_matrix</span><span class="p">:</span> <span class="s1">&#39;ndarray&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            center (Point): The center of the arc.</span>
<span class="sd">            radius_x (float): The x radius of the arc.</span>
<span class="sd">            radius_y (float): The y radius for elliptical arcs.</span>
<span class="sd">            start_angle (float): The starting angle of the arc.</span>
<span class="sd">            span_angle (float): The span angle of the arc.</span>
<span class="sd">            rot_angle (float, optional): Rotation angle. Defaults to 0. If negative, the arc is drawn clockwise.</span>
<span class="sd">            xform_matrix (ndarray, optional): Transformation matrix. Defaults to None.</span>
<span class="sd">            **kwargs: Additional keyword arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">radius_y</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">radius_y</span> <span class="o">=</span> <span class="n">radius_x</span>
        <span class="k">if</span> <span class="n">n_points</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s1">&#39;n_arc_points&#39;</span><span class="p">]</span>
            <span class="n">n_points</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">span_angle</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span><span class="p">))</span>

        <span class="n">vertices</span> <span class="o">=</span> <span class="n">elliptic_arc_points</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">radius_x</span><span class="p">,</span> <span class="n">radius_y</span><span class="p">,</span> <span class="n">start_angle</span><span class="p">,</span> <span class="n">span_angle</span><span class="p">,</span> <span class="n">n_points</span><span class="o">=</span><span class="n">n_points</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rot_angle</span><span class="p">:</span>
            <span class="n">rot_matrix</span> <span class="o">=</span> <span class="n">rotation_matrix</span><span class="p">(</span><span class="n">rot_angle</span><span class="p">,</span> <span class="n">center</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">xform_matrix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">xform_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rot_matrix</span><span class="p">,</span> <span class="n">xform_matrix</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">xform_matrix</span> <span class="o">=</span> <span class="n">rot_matrix</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">xform_matrix</span><span class="o">=</span><span class="n">xform_matrix</span><span class="p">,</span>  <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">ARC</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_points</span> <span class="o">=</span> <span class="n">n_points</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;start_angle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">start_angle</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;span_angle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">span_angle</span>
        <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span> <span class="o">=</span> <span class="n">center</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_c</span> <span class="o">=</span> <span class="p">[</span><span class="n">cx</span><span class="p">,</span> <span class="n">cy</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">_a</span> <span class="o">=</span> <span class="p">[</span><span class="n">radius_x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">_b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">radius_y</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orig_triangle</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_c</span><span class="p">[:],</span> <span class="n">_a</span><span class="p">,</span> <span class="n">_b</span><span class="p">]</span>


    <span class="k">def</span><span class="w"> </span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set an attribute of the arc.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): The name of the attribute.</span>
<span class="sd">            value (Any): The value of the attribute.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;center&quot;</span><span class="p">:</span>
            <span class="n">diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">value</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">diff</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">diff</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reps</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;radius_x&quot;</span><span class="p">:</span>
            <span class="n">c</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orig_triangle</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">xform_matrix</span>
            <span class="n">cur_radius</span> <span class="o">=</span> <span class="n">distance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
            <span class="n">ratio</span> <span class="o">=</span> <span class="n">value</span> <span class="o">/</span> <span class="n">cur_radius</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">ratio</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">about</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;radius_y&quot;</span><span class="p">:</span>
            <span class="n">c</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orig_triangle</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">xform_matrix</span>
            <span class="n">cur_radius</span> <span class="o">=</span> <span class="n">distance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
            <span class="n">ratio</span> <span class="o">=</span> <span class="n">value</span> <span class="o">/</span> <span class="n">cur_radius</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ratio</span><span class="p">,</span> <span class="n">about</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;start_angle&quot;</span><span class="p">:</span>
            <span class="n">center</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orig_triangle</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">xform_matrix</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">distance</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">distance</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
            <span class="n">span</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">span_angle</span>
            <span class="n">n_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_points</span>
            <span class="n">points</span> <span class="o">=</span> <span class="n">elliptic_arc_points</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">span</span><span class="p">,</span> <span class="n">n_points</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">primary_points</span> <span class="o">=</span> <span class="n">Points</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;start_angle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;span_angle&quot;</span><span class="p">:</span>
            <span class="n">center</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orig_triangle</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">xform_matrix</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">distance</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">distance</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
            <span class="n">start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_angle</span>
            <span class="n">n_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_points</span>
            <span class="n">points</span> <span class="o">=</span> <span class="n">elliptic_arc_points</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">n_points</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">primary_points</span> <span class="o">=</span> <span class="n">Points</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;span_angle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">center</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the center of the arc.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Point: The center of the arc.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_c</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">xform_matrix</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[:</span><span class="mi">2</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">radius_x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the x radius of the arc.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: The x radius of the arc.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">c</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orig_triangle</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">xform_matrix</span>
        <span class="k">return</span> <span class="n">distance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">radius_y</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the y radius of the arc.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: The y radius of the arc.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">c</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orig_triangle</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">xform_matrix</span>
        <span class="k">return</span> <span class="n">distance</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>

<div class="viewcode-block" id="Arc.copy">
<a class="viewcode-back" href="../../../simetri.geometry.html#simetri.geometry.ellipse.Arc.copy">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Return a copy of the arc.&#39;&#39;&#39;</span>
        <span class="n">center</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span>
        <span class="n">start_angle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_angle</span>
        <span class="n">span_angle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">span_angle</span>
        <span class="n">radius_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius_x</span>
        <span class="n">radius_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius_y</span>


        <span class="n">arc</span> <span class="o">=</span> <span class="n">Arc</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">radius_x</span><span class="p">,</span> <span class="n">radius_y</span><span class="p">,</span> <span class="n">start_angle</span><span class="p">,</span> <span class="n">span_angle</span><span class="p">,</span> <span class="n">rot_angle</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">arc</span><span class="o">.</span><span class="n">primary_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">primary_points</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">arc</span><span class="o">.</span><span class="n">xform_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xform_matrix</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">arc</span><span class="o">.</span><span class="n">_orig_triangle</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_orig_triangle</span><span class="p">)</span>
        <span class="n">arc</span><span class="o">.</span><span class="n">_c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_c</span><span class="p">[:]</span>
        <span class="n">arc</span><span class="o">.</span><span class="n">n_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_points</span>

        <span class="k">for</span> <span class="n">attrib</span> <span class="ow">in</span> <span class="n">shape_style_map</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">arc</span><span class="p">,</span> <span class="n">attrib</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrib</span><span class="p">))</span>
        <span class="n">arc</span><span class="o">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtype</span>
        <span class="n">custom_attribs</span> <span class="o">=</span> <span class="n">custom_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">arc_attribs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="s1">&#39;start_angle&#39;</span><span class="p">,</span> <span class="s1">&#39;span_angle&#39;</span><span class="p">,</span> <span class="s1">&#39;radius_x&#39;</span><span class="p">,</span> <span class="s1">&#39;radius_y&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">attrib</span> <span class="ow">in</span> <span class="n">custom_attribs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">attrib</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">arc_attribs</span><span class="p">:</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">arc</span><span class="p">,</span> <span class="n">attrib</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrib</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">arc</span></div>
</div>



<div class="viewcode-block" id="Ellipse">
<a class="viewcode-back" href="../../../simetri.geometry.html#simetri.geometry.ellipse.Ellipse">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Ellipse</span><span class="p">(</span><span class="n">Shape</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;An ellipse defined by center, width, and height.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">center</span><span class="p">:</span> <span class="n">Point</span><span class="p">,</span> <span class="n">width</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">height</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                                <span class="n">xform_matrix</span><span class="p">:</span><span class="s1">&#39;ndarray&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            center (Point): The center of the ellipse.</span>
<span class="sd">            width (float): The width of the ellipse.</span>
<span class="sd">            height (float): The height of the ellipse.</span>
<span class="sd">            angle (float, optional): Rotation angle. Defaults to 0.</span>
<span class="sd">            xform_matrix (ndarray, optional): Transformation matrix. Defaults to None.</span>
<span class="sd">            **kwargs: Additional keyword arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n_points</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s2">&quot;n_ellipse_points&quot;</span><span class="p">]</span>
        <span class="n">vertices</span> <span class="o">=</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ellipse_points</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n_points</span><span class="p">)]</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xform_matrix</span><span class="o">=</span><span class="n">xform_matrix</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">height</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">center</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">height</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">angle</span> <span class="o">=</span> <span class="n">angle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">smooth</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="n">Types</span><span class="o">.</span><span class="n">ELLIPSE</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">closed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True ellipse is always closed.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Always returns True.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="nd">@closed</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">closed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xform_matrix</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">reps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Batch</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Used internally. Update the shape with a transformation matrix.</span>

<span class="sd">        Args:</span>
<span class="sd">            xform_matrix (array): The transformation matrix.</span>
<span class="sd">            reps (int, optional): The number of repetitions, defaults to 0.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Batch: The updated shape or a batch of shapes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">reps</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">center</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">start</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">end</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="n">center</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">]</span>
            <span class="n">center2</span><span class="p">,</span> <span class="n">start2</span><span class="p">,</span> <span class="n">end2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">xform_matrix</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">center2</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_point</span> <span class="o">=</span> <span class="n">start2</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_point</span> <span class="o">=</span> <span class="n">end2</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_angle</span> <span class="o">=</span> <span class="n">line_angle</span><span class="p">(</span><span class="n">center2</span><span class="p">,</span> <span class="n">start2</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_update</span><span class="p">(</span><span class="n">xform_matrix</span><span class="p">,</span> <span class="n">reps</span><span class="p">)</span>


<div class="viewcode-block" id="Ellipse.copy">
<a class="viewcode-back" href="../../../simetri.geometry.html#simetri.geometry.ellipse.Ellipse.copy">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a copy of the ellipse.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Ellipse: A copy of the ellipse.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">center</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span>
        <span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span>
        <span class="n">height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span>
        <span class="n">ellipse</span> <span class="o">=</span> <span class="n">Ellipse</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>
        <span class="n">custom_attribs</span> <span class="o">=</span> <span class="n">custom_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">attrib</span> <span class="ow">in</span> <span class="n">custom_attribs</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">ellipse</span><span class="p">,</span> <span class="n">attrib</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrib</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">ellipse</span></div>
</div>



<div class="viewcode-block" id="ellipse_tangent">
<a class="viewcode-back" href="../../../simetri.geometry.html#simetri.geometry.ellipse.ellipse_tangent">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">ellipse_tangent</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">.001</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates the angle of the tangent line to an ellipse at the point (x, y).</span>

<span class="sd">    Args:</span>
<span class="sd">        a (float): Semi-major axis of the ellipse.</span>
<span class="sd">        b (float): Semi-minor axis of the ellipse.</span>
<span class="sd">        x (float): x-coordinate of the point.</span>
<span class="sd">        y (float): y-coordinate of the point.</span>
<span class="sd">        tol (float, optional): Tolerance for point on ellipse check. Defaults to .001.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: Angle of the tangent line in radians.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">((</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">tol</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># res = atan2(-(b**2 * x), (a**2 * y))</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">((</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="p">),</span> <span class="o">-</span><span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">y</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">res</span></div>



<div class="viewcode-block" id="r_central">
<a class="viewcode-back" href="../../../simetri.geometry.html#simetri.geometry.ellipse.r_central">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">r_central</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Return the radius (distance between the center and the intersection point)</span>
<span class="sd">    of the ellipse at the given angle.</span>

<span class="sd">    Args:</span>
<span class="sd">        a (float): Semi-major axis of the ellipse.</span>
<span class="sd">        b (float): Semi-minor axis of the ellipse.</span>
<span class="sd">        theta (float): Angle in radians.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: Radius at the given angle.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">b</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span></div>



<div class="viewcode-block" id="ellipse_line_intersection">
<a class="viewcode-back" href="../../../simetri.geometry.html#simetri.geometry.ellipse.ellipse_line_intersection">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">ellipse_line_intersection</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">point</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Return the intersection points of an ellipse and a line segment</span>
<span class="sd">    connecting the given point to the ellipse center at (0, 0).</span>

<span class="sd">    Args:</span>
<span class="sd">        a (float): Semi-major axis of the ellipse.</span>
<span class="sd">        b (float): Semi-minor axis of the ellipse.</span>
<span class="sd">        point (tuple): Point coordinates (x, y).</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: Intersection points.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># adapted from http://mathworld.wolfram.com/Ellipse-LineIntersection.html</span>
    <span class="c1"># a, b is the ellipse width/2 and height/2 and (x_0, y_0) is the point</span>

    <span class="n">x_0</span><span class="p">,</span> <span class="n">y_0</span> <span class="o">=</span> <span class="n">point</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">x</span> <span class="o">=</span>	<span class="p">((</span><span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">y_0</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x_0</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span> <span class="o">*</span> <span class="n">x_0</span>
    <span class="n">y</span> <span class="o">=</span>	<span class="p">((</span><span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">y_0</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x_0</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span> <span class="o">*</span> <span class="n">y_0</span>

    <span class="k">return</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">y</span><span class="p">)]</span></div>



<div class="viewcode-block" id="elliptic_arc_points">
<a class="viewcode-back" href="../../../simetri.geometry.html#simetri.geometry.ellipse.elliptic_arc_points">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">elliptic_arc_points</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">radius_x</span><span class="p">,</span> <span class="n">radius_y</span><span class="p">,</span> <span class="n">start_angle</span><span class="p">,</span> <span class="n">span_angle</span><span class="p">,</span>  <span class="n">n_points</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate points on an elliptic arc.</span>
<span class="sd">    These are generated from the parametric equations of the ellipse.</span>
<span class="sd">    They are not evenly spaced.</span>

<span class="sd">    Args:</span>
<span class="sd">        center (tuple): (x, y) coordinates of the ellipse center.</span>
<span class="sd">        radius_x (float): Length of the semi-major axis.</span>
<span class="sd">        radius_y (float): Length of the semi-minor axis.</span>
<span class="sd">        start_angle (float): Starting angle of the arc.</span>
<span class="sd">        span_angle (float): Span angle of the arc.</span>
<span class="sd">        n_points (int): Number of points to generate.</span>

<span class="sd">    Returns:</span>
<span class="sd">        numpy.ndarray: Array of (x, y) coordinates of the ellipse points.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rx</span> <span class="o">=</span> <span class="n">radius_x</span>
    <span class="k">if</span> <span class="n">radius_y</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">radius_y</span> <span class="o">=</span> <span class="n">radius_x</span>
    <span class="n">ry</span> <span class="o">=</span> <span class="n">radius_y</span>
    <span class="k">if</span> <span class="n">n_points</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="s1">&#39;n_arc_points&#39;</span><span class="p">]</span>
        <span class="n">n_points</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">span_angle</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span><span class="p">))</span>
    <span class="n">start_angle</span> <span class="o">=</span> <span class="n">positive_angle</span><span class="p">(</span><span class="n">start_angle</span><span class="p">)</span>
    <span class="n">clockwise</span> <span class="o">=</span> <span class="n">span_angle</span> <span class="o">&lt;</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">clockwise</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">start_angle</span> <span class="o">+</span> <span class="n">span_angle</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">end_angle</span> <span class="o">=</span> <span class="n">positive_angle</span><span class="p">(</span><span class="n">start_angle</span> <span class="o">+</span> <span class="n">span_angle</span><span class="p">)</span>
            <span class="n">t0</span> <span class="o">=</span> <span class="n">get_ellipse_t_for_angle</span><span class="p">(</span><span class="n">end_angle</span><span class="p">,</span> <span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">)</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="n">get_ellipse_t_for_angle</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">,</span> <span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">)</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">n_points</span><span class="p">)</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">rx</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">ry</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="n">slice1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
            <span class="n">t0</span> <span class="o">=</span> <span class="n">get_ellipse_t_for_angle</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">)</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="n">get_ellipse_t_for_angle</span><span class="p">(</span><span class="n">start_angle</span><span class="p">,</span> <span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">)</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">n_points</span><span class="p">)</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">rx</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">ry</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="n">slice2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">slice1</span><span class="p">,</span> <span class="n">slice2</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">end_angle</span> <span class="o">=</span> <span class="n">start_angle</span> <span class="o">+</span> <span class="n">span_angle</span>
            <span class="n">t0</span> <span class="o">=</span> <span class="n">get_ellipse_t_for_angle</span><span class="p">(</span><span class="n">end_angle</span><span class="p">,</span> <span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">)</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="n">get_ellipse_t_for_angle</span><span class="p">(</span><span class="n">start_angle</span><span class="p">,</span> <span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">)</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">n_points</span><span class="p">)</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">rx</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">ry</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">start_angle</span> <span class="o">+</span> <span class="n">span_angle</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">:</span>
            <span class="n">t0</span> <span class="o">=</span> <span class="n">get_ellipse_t_for_angle</span><span class="p">(</span><span class="n">start_angle</span><span class="p">,</span> <span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">)</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="n">get_ellipse_t_for_angle</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">,</span> <span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">)</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">n_points</span><span class="p">)</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">rx</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">ry</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="n">slice1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>

            <span class="n">t0</span> <span class="o">=</span> <span class="n">get_ellipse_t_for_angle</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">)</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="n">get_ellipse_t_for_angle</span><span class="p">(</span><span class="n">start_angle</span> <span class="o">+</span> <span class="n">span_angle</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">,</span> <span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">)</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">n_points</span><span class="p">)</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">rx</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">ry</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="n">slice2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>

            <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">slice1</span><span class="p">,</span> <span class="n">slice2</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">end_angle</span> <span class="o">=</span> <span class="n">start_angle</span> <span class="o">+</span> <span class="n">span_angle</span>
            <span class="n">t0</span> <span class="o">=</span> <span class="n">get_ellipse_t_for_angle</span><span class="p">(</span><span class="n">start_angle</span><span class="p">,</span> <span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">)</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="n">get_ellipse_t_for_angle</span><span class="p">(</span><span class="n">end_angle</span><span class="p">,</span> <span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">)</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">n_points</span><span class="p">)</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">rx</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">ry</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">res</span></div>



<div class="viewcode-block" id="ellipse_points">
<a class="viewcode-back" href="../../../simetri.geometry.html#simetri.geometry.ellipse.ellipse_points">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">ellipse_points</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">n_points</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate points on an ellipse.</span>
<span class="sd">    These are generated from the parametric equations of the ellipse.</span>
<span class="sd">    They are not evenly spaced.</span>

<span class="sd">    Args:</span>
<span class="sd">        center (tuple): (x, y) coordinates of the ellipse center.</span>
<span class="sd">        a (float): Length of the semi-major axis.</span>
<span class="sd">        b (float): Length of the semi-minor axis.</span>
<span class="sd">        n_points (int): Number of points to generate.</span>

<span class="sd">    Returns:</span>
<span class="sd">        numpy.ndarray: Array of (x, y) coordinates of the ellipse points.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span><span class="p">,</span> <span class="n">n_points</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span></div>



<div class="viewcode-block" id="elliptic_arclength">
<a class="viewcode-back" href="../../../simetri.geometry.html#simetri.geometry.ellipse.elliptic_arclength">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">elliptic_arclength</span><span class="p">(</span><span class="n">t_0</span><span class="p">,</span> <span class="n">t_1</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Return the arclength of an ellipse between the given parametric angles.</span>
<span class="sd">    The ellipse has semi-major axis a and semi-minor axis b.</span>

<span class="sd">    Args:</span>
<span class="sd">        t_0 (float): Starting parametric angle.</span>
<span class="sd">        t_1 (float): Ending parametric angle.</span>
<span class="sd">        a (float): Semi-major axis of the ellipse.</span>
<span class="sd">        b (float): Semi-minor axis of the ellipse.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: Arclength of the ellipse.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">ellipeinc</span> <span class="c1"># this takes too long to import</span>
    <span class="n">m</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">b</span> <span class="o">/</span> <span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">ellipeinc</span><span class="p">(</span><span class="n">t_1</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">pi</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
    <span class="n">t0</span> <span class="o">=</span> <span class="n">ellipeinc</span><span class="p">(</span><span class="n">t_0</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">pi</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">t1</span> <span class="o">-</span> <span class="n">t0</span><span class="p">)</span></div>



<div class="viewcode-block" id="central_to_parametric_angle">
<a class="viewcode-back" href="../../../simetri.geometry.html#simetri.geometry.ellipse.central_to_parametric_angle">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">central_to_parametric_angle</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">phi</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts a central angle to a parametric angle on an ellipse.</span>

<span class="sd">    Args:</span>
<span class="sd">        a (float): Semi-major axis of the ellipse.</span>
<span class="sd">        b (float): Semi-minor axis of the ellipse.</span>
<span class="sd">        phi (float): Angle of the line intersecting the center and the point.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: Parametric angle (in radians).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">((</span><span class="n">a</span><span class="o">/</span><span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span> <span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">t</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span>

    <span class="k">return</span> <span class="n">t</span></div>



<div class="viewcode-block" id="parametric_to_central_angle">
<a class="viewcode-back" href="../../../simetri.geometry.html#simetri.geometry.ellipse.parametric_to_central_angle">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">parametric_to_central_angle</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts a parametric angle on an ellipse to a central angle.</span>

<span class="sd">    Args:</span>
<span class="sd">        a (float): Semi-major axis of the ellipse.</span>
<span class="sd">        b (float): Semi-minor axis of the ellipse.</span>
<span class="sd">        t (float): Parametric angle (in radians).</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: Angle of the line intersecting the center and the point.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">((</span><span class="n">b</span><span class="o">/</span><span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">phi</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">phi</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span>

    <span class="k">return</span> <span class="n">phi</span></div>



<div class="viewcode-block" id="ellipse_point">
<a class="viewcode-back" href="../../../simetri.geometry.html#simetri.geometry.ellipse.ellipse_point">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">ellipse_point</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Return a point on an ellipse with the given a=width/2, b=height/2, and angle.</span>
<span class="sd">    angle is the central-angle and in radians.</span>

<span class="sd">    Args:</span>
<span class="sd">        a (float): Semi-major axis of the ellipse.</span>
<span class="sd">        b (float): Semi-minor axis of the ellipse.</span>
<span class="sd">        angle (float): Central angle in radians.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: Coordinates of the point on the ellipse.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">r_central</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">r</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="n">r</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span></div>



<div class="viewcode-block" id="ellipse_param_point">
<a class="viewcode-back" href="../../../simetri.geometry.html#simetri.geometry.ellipse.ellipse_param_point">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">ellipse_param_point</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Return a point on an ellipse with the given a=width/2, b=height/2, and parametric angle.</span>
<span class="sd">    t is the parametric angle and in radians.</span>

<span class="sd">    Args:</span>
<span class="sd">        a (float): Semi-major axis of the ellipse.</span>
<span class="sd">        b (float): Semi-minor axis of the ellipse.</span>
<span class="sd">        t (float): Parametric angle in radians.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: Coordinates of the point on the ellipse.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">b</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">))</span></div>



<div class="viewcode-block" id="get_ellipse_t_for_angle">
<a class="viewcode-back" href="../../../simetri.geometry.html#simetri.geometry.ellipse.get_ellipse_t_for_angle">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_ellipse_t_for_angle</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the parameter t for a given angle on an ellipse.</span>

<span class="sd">    Args:</span>
<span class="sd">        angle (float): The angle in radians.</span>
<span class="sd">        a (float): Semi-major axis of the ellipse.</span>
<span class="sd">        b (float): Semi-minor axis of the ellipse.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: The parameter t.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="n">b</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">t</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span>
    <span class="k">return</span> <span class="n">t</span></div>



<div class="viewcode-block" id="ellipse_central_angle">
<a class="viewcode-back" href="../../../simetri.geometry.html#simetri.geometry.ellipse.ellipse_central_angle">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">ellipse_central_angle</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the central angle of an ellipse for a given parameter t.</span>

<span class="sd">    Args:</span>
<span class="sd">        t (float): The parameter value.</span>
<span class="sd">        a (float): The semi-major axis of the ellipse.</span>
<span class="sd">        b (float): The semi-minor axis of the ellipse.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: The central angle in radians.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">b</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">theta</span></div>

</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">simetri.graphics</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">API Reference:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">src</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Fahri Basegmez.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.1.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
    </div>

    

    
  </body>
</html>